<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>柏青哥的 SuSE Linux -- 架設 Web Server</title>
<style type="text/css">
<!--
a {
	color: #000099;
	text-decoration: none;
}
-->
</style>
</head>

<body background="sumtextb.jpg" tppabs="http://www.suse.url.tw/sumtextb.jpg" link="#000099" vlink="#000099" alink="#000099" leftmargin="40">
<div align="left"> <a href="index-1.htm" tppabs="http://www.suse.url.tw/sles10/index.htm" target="_blank"><img src="first.GIF" tppabs="http://www.suse.url.tw/first.GIF" width="40" height="40" border="0" align="middle"></a><font color="#000000" size="+1">　　</font><font color="#000000">作者：陳柏菁</font><font color="#000000" size="+1"> 
  　 </font>E-mail：pachingko@ms96.url.com.tw 
  <table width="100%" border="0">
    <tr> 
      <td nowrap> <div align="left"></div>
        <div align="center"> 
          <div align="center"><font color="#000000" size="7"><strong>第十六章　架 設 
            Web Server</strong></font></div>
          <font color="#0000FF" size="+1"><strong></strong></font></div>
        <div align="center"></div></td>
    </tr>
  </table>
  <font size="+1"><font color="#660066"><strong><font color="#0000FF"><br>
  <font color="#000099">索引：</font></font></strong></font></font> 
  <table width="100%" border="0">
    <tr> 
      <td colspan="3"><font color="#000099"><strong>16.1 <a href="#1">WWW、HTTP 
        及 Apache</a></strong></font></td>
    </tr>
    <tr> 
      <td width="4%"><font color="#000099">&nbsp;</font></td>
      <td width="6%" align="center" valign="top" nowrap><font color="#000099">16.1.1</font></td>
      <td width="90%"><a href="#2">WWW 與 HTTP 簡介</a></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td align="center" valign="top" nowrap><p><font color="#000099">16.1.2</font></p></td>
      <td><a href="#3">Apache 簡介</a></td>
    </tr>
    <tr> 
      <td colspan="3"><font color="#000099"><strong>16.2 <a href="#4">安裝 Apache 
        套件及瀏覽套件內容</a></strong></font></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td colspan="2" align="center" valign="top" nowrap><div align="left"><a href="#5">Apache 
          相關套件</a><br>
          <a href="#6">查看套件內容</a><br>
          <a href="#30">設定開機時啟動 Apache 服務 </a> <br>
        </div></td>
    </tr>
    <tr> 
      <td colspan="3"><font color="#000099"><strong>16.3 <a href="#7">Apache 的相關設定檔說明</a></strong></font></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td align="center" valign="top" nowrap><font color="#000099">16.3.1</font></td>
      <td><font color="#000099"><a href="#8">設定 Apache</a> ---<br>
        <a href="#9">/etc/apache2/httpd.conf</a> 、<a href="#10">/etc/apache2/default-server.conf</a>、<a href="#11">/etc/apache2/listen.conf</a>、<br>
        <a href="#13">/etc/apache2/server-tuning.conf</a>、<a href="#14">/etc/apache2/uid.conf</a> 
        、<a href="#15">/etc/apache2/mod_userdir.conf</a></font></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td align="center" valign="top" nowrap><font color="#000099">16.3.2</font></td>
      <td><a href="#16">建立使用者個人網頁</a></td>
    </tr>
    <tr> 
      <td colspan="3"><font color="#000099"><strong>16.4 <a href="#17">設定認證目錄及 
        .htaccess 的使用</a></strong></font></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td align="center" valign="top" nowrap><font color="#000099">16.4.1</font></td>
      <td><a href="#18">認證目錄</a></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td align="center" valign="top" nowrap><font color="#000099">16.4.2</font></td>
      <td><a href="#19">.htaccess 的使用</a></td>
    </tr>
    <tr> 
      <td colspan="3"><font color="#000099"><strong>16.5 <a href="#20">虛擬主機的設定</a></strong></font></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td align="center" valign="top" nowrap><font color="#000099">16.5.1</font></td>
      <td><a href="#21">虛擬主機概述</a></td>
    </tr>
    <tr> 
      <td><font color="#000099">&nbsp;</font></td>
      <td align="center" valign="top" nowrap><font color="#000099">16.5.2</font></td>
      <td><a href="#22">設定虛擬主機</a></td>
    </tr>
  </table>
  <font size="+1"><font color="#660066"><strong><font color="#0000FF"> </font></strong></font></font> 
  <br>
  <hr>
  <font size="+1"><font color="#660066"><strong><font color="#0000FF"><br>
  <a name="1"></a><font size="6">16.1 WWW、HTTP</font></font></strong><font color="#0000FF" size="6"><strong> 
  與 Apache</strong></font><font color="#000000"><br>
  <br>
  </font></font></font><font color="#660066"><font color="#000000"><strong><font size="+1"><a name="2"></a><font size="5">16.1.1 
  WWW 與 HTTP 簡介</font></font></strong><br>
  <br>
  　先來介紹 WWW (World Wide Web) 這個名詞，其翻成中文就是所謂的全球資訊網，它是 Internet 上很重要的一項網路服務，可以提供進一步的網路資訊交換。早期尚未發展出 
  WWW 時，就只能傳輸一些文字資料而已，對於其他像影像、圖片<font color="#660066">、</font>聲音等，必須先將檔案編碼後才能傳輸。而到了發展出 
  WWW 之後，資料交換的過程就可以包含文字、影像、圖片、聲音等等多媒體的資訊，所以現在大家在 Internet 上才可以透過超連結看到很多美美的網頁，而提供網頁瀏覽服務的伺服器，就被稱為 
  Web Server 或 WWW Server。<br>
  <br>
  　WWW 的文件是由 html 語法所組成，當在撰寫 html 時，可以為不同的資料型態前面加上不同的資料屬性標籤，這樣當 Client 端在接收網頁時，就可以針對不同的資料型態作解析，最後方能將完整的網頁呈現在使用者面前。</font></font> 
  <p>　再來談到的是 HTTP，在 WWW Server 與 Client 端瀏覽器之間，用來彼此溝通的語言就是 HTTP 協定，其全名為 <strong>H</strong>yper<strong> 
    T</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol，所以不論是 Server 
    端或 Client 端在做資料傳輸時，都要依照 HTTP 的標準來進行，而我們所要架設的 Web Server，當然也要支援此項標準。<br>
    <br>
    　綜合以上所述，可以了解到，當 Client 端使用瀏覽器程式 (explorer、netscape、mozilla) 來存取 Web Server 
    所提供的 WWW 資料時，就是透過 HTTP 協定來做網頁資料的傳輸，而瀏覽器的主要作用，就是在解析 html 的程式碼，並將解析後的結果呈現在瀏覽器的視窗之中。<br>
    <br>
    　另外附帶一提的就是 URL (Uniform Resource Locator) 這個名詞，它是表示 WWW 連結時的語法，比如我們輸入網址：<a href="javascript:if(confirm(%27http://www.hinet.net/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.hinet.net/%27" tppabs="http://www.hinet.net/" target="_blank">http://www.hinet.net/</a>，這就是一個 
    URL 了，其中 http 是指出資料傳輸時要使用的協定，www.hinet.net 就是 FQDN 囉。所以當 Client 端輸入這樣一個 URL 
    時，會先透過 DNS 解析出此 FQDN 所對應的 IP 位址，然後再利用 http 協定來與 WWW 主機的 80 port 做聯繫。<br>
    <br>
    　 一般來說，URL 最後有以「/」做結尾時，如 http://www.domain.com/test/，那麼 test 是代表目錄之意，那沒有以 
    「/」做結尾時，如 http://www.domain.com/test，則 test 代表的是一個檔案。<br>
    <font size="+1"><font color="#660066"><br>
    </font><font color="#0000FF"><strong> <font color="#000000"><a name="3"></a><font size="5">16.1.2 
    Apache 簡介</font><br>
    </font><br>
    </strong></font></font>　Web Server 最出名也最被廣泛使用的一套軟體為 Apache。Apache 的前身為 NCSA 
    ( National Center for Supercomputing Applications )，而 NCSA 於 1995 年為排名第一的 
    Web Server 軟體，後來 NCSA 經過一連串的修正，便產生了今日舉世聞名的 Apache。<br>
    <br>
    　 至於 Apache 這個名稱的由來，是因為當初的研發團隊針對 NCSA 這個老牌的伺服器軟體不斷的修正而來：<font color="#000000"><strong>a 
    patchy server</strong></font>，所以才取名為 Apache。又因為 Apache 這個名稱剛好與美國的一個原住民名稱相同，所以 
    Apache 的 Logo 就以彩色的羽毛來作為其標誌圖案。<font size="+1"><br>
    <br>
    <strong><font color="#0000FF"><a name="4"></a><font size="6">16.2 </font></font></strong> 
    <font color="#0000FF" size="6"><strong>安裝 Apache 套件及瀏覽套件內容</strong></font><font color="#0000FF"><strong><font size="+1"><br>
    <br>
    </font></strong></font></font><font color="#0000FF"><font color="#000000">　這裡需要安裝的套件<font size="+1">，</font>需視您實際需求而定，如果只是架設個單純的靜態網站，那麼可參考這裡的說明，不過如果是要做個能跟使用者做互動的動態網站，則像 
    mysql 及 php 的相關套件，也要一併安裝。</font></font><font color="#0000FF"><font size="+1"><strong><font size="+1"><br>
    <br>
    <font color="#000000"><a name="5"></a></font></font><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"><font size="+1"><font color="#000000"> 
    Apache 相關套件</font></font></strong></font></font></p>
  <table width="69%" border="1">
    <tr bgcolor="#CCCCCC"> 
      <td width="19%" nowrap> <div align="center"><font color="#000099"><strong>套 
          件 名 稱</strong></font></div></td>
      <td width="81%" nowrap> <div align="center"><font color="#000099"><strong>簡　單　描　述</strong></font></div></td>
    </tr>
    <tr> 
      <td nowrap> <div align="center"><font color="#000099">apache2</font></div></td>
      <td nowrap><font color="#000099">Apache 的主要套件之一。</font></td>
    </tr>
    <tr> 
      <td nowrap> <div align="center"><font color="#000099">apache2-prefork</font></div></td>
      <td nowrap><font color="#000099">包含 httpd2-prefork 這個 daemon 及一些 Apache 
        相關模組的符號連結檔。</font></td>
    </tr>
  </table>
</div>
<blockquote> 
  <div align="left"><strong><font color="#000099">Tips：</font></strong><font color="#000099" size="2">如您尚未安裝的話，建議使用 
    YaST 將其裝上，這樣可解決套件相依性的問題。另外還有個選擇性的套件 apache2-example-pages，其內只包含 index.html 
    檔案及一些圖檔而已，不裝也行。</font></div>
</blockquote>
<div align="left"> 
  <p> <font color="#000000" size="+1"><strong><a name="6"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"> 
    查看套件內容</strong></font></p>
  <table width="100%" border="0">
    <tr> 
      <td nowrap bgcolor="#000000"><font color="#FFFFFF">suse:~ #<font color="#FFFF00"><strong> 
        rpm -ql apache2</strong></font><br>
        /etc/apache2/　<br>
        <font color="#00FFFF"># </font><font color="#00FFFF" size="2">Apache 的一些相關組態檔都安置在這個目錄中。<br>
        </font></font><font color="#FFFFFF"> /etc/apache2/default-server.conf　<br>
        <font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">此檔包含了基本的 
        Apache 設定項目。</font></font><font color="#FFFFFF"><br>
        /etc/apache2/httpd.conf<br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">Apache 
        的主要設定檔。<br>
        </font><font color="#FFFFFF">/etc/apache2/listen.conf</font><font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">設定 
        Apache 所 listen 的介面位址及 port number。<br>
        </font><font color="#FFFFFF">/etc/apache2/mod_mime-defaults.conf　<font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">這是 
        Apache 預設編碼的檔案。<br>
        </font></font><font color="#FFFFFF">/etc/apache2/mod_userdir.conf　<br>
        <font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">有關使用者個人網頁的相關設定。<br>
        </font>/etc/apache2/server-tuning.conf　<br>
        <font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">這個檔案的設定參數，可以用來調整 
        Apache 的執行效能。</font> <br>
        /etc/apache2/uid.conf</font><font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">設定以什麼身分來執行 
        Apache 的 daemon (/usr/sbin/httpd2-prefork)。<br>
        </font><font color="#FFFFFF">/etc/apache2/vhosts.d/</font><font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">這是一個可以包含虛擬主機設定檔的目錄。<br>
        </font><font color="#FFFFFF">/etc/init.d/apache2</font><font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">管理 
        Apache 服務的 script。<br>
        </font><font color="#FFFFFF">/usr/sbin/apache2ctl</font><font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">也可用這個指令來管理 
        Apache。另外亦可用來測試設定語法的正確性。<br>
        </font><font color="#FFFFFF">/usr/sbin/htpasswd2<br>
        <font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">設定使用者認證的指令。<br>
        </font><font color="#FFFFFF">/usr/sbin/rcapache2</font><font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">連結至 
        /etc/init.d/apache2 的符號連結檔。<br>
        </font><font color="#FFFFFF">/var/log/apache2/ </font><font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">此目錄包含 
        Apache 的一些紀錄檔，如 error_log 及 access_log 等。</font><font color="#FFFFFF">&nbsp; 
        </font> </td>
    </tr>
  </table>
  <br>
  <strong><a name="30"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"> 
  <font size="4">設定開機時啟動 Apache 服務</font></strong><br>
  <br>
  <table width="100%" border="0" bgcolor="#000000">
    <tr>
      <td height="25"><font color="#FFFFFF">suse:~ # <strong><font color="#FFFF00">chkconfig 
        apache2 35</font></strong></font></td>
    </tr>
  </table>
  <p> <font color="#0000FF" size="+1"><strong><a name="7"></a><font size="6">16.3 
    Apache 的相關設定檔說明</font></strong></font><br>
    <br>
    　Apache 的設定檔被安置在 /etc/apache2 目錄下，您可以切換至這個目錄並概略的瀏覽一下有哪些檔案存在。以下我們會針對幾個比較重要的設定檔來做說明。<br>
    <br>
    <font color="#000000" size="+1"><strong><a name="8"></a><font size="5">16.3.1 
    設定 Apache</font></strong></font><font color="#000000" size="5"><strong>　<br>
    </strong></font><font color="#000000"><strong>　<br>
    </strong></font><font color="#000000" size="+1"><strong><a name="9"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"> 
    <font size="+1">/etc/apache2/httpd.conf</font><font size="5"> <br>
    </font></strong></font><font color="#000000"><strong><br>
    　</strong></font>這是 Apache 的主要設定檔，裡邊包含了 include 敘述 ( 指出 Apache 相關設定檔的存放位置 
    ) 及全域參數的設定 ( global setting )。檔案內容共區分成三大部分：Global Environment、Main server 
    configuration 及 Virtual server configuration。</p>
  <table width="100%" border="0">
    <tr> 
      <td nowrap bgcolor="#000000"><p><font color="#FFFFFF">suse:~ # <strong><font color="#FFFF00">vi 
          /etc/apache2/httpd.conf</font><br>
          </strong><br>
          <font size="+1"><strong><font color="#0099FF">### Global Environment 
          ###</font></strong></font><font color="#0099FF"><br>
          <br>
          # run under this user/group id</font><br>
          <strong>Include /etc/apache2/uid.conf </strong><br>
          <br>
          <font color="#0099FF"># - how many server processes to start (server 
          pool regulation)<br>
          # - usage of KeepAlive</font><br>
          <strong>Include /etc/apache2/server-tuning.conf <br>
          </strong><br>
          <font color="#0099FF"># IP addresses / ports to listen on</font><br>
          <strong>Include /etc/apache2/listen.conf</strong><br>
          <br>
          <font color="#0099FF"># associate MIME types with filename extensions</font><br>
          TypesConfig /etc/apache2/mime.types<br>
          DefaultType text/plain<br>
          <strong>Include /etc/apache2/mod_mime-defaults.conf</strong><br>
          <font color="#00FFFF"># <font size="2">以上每個檔案的功用，請參考前面套件內容的說明。</font></font><br>
          <br>
          <font color="#0099FF"># use .htaccess files for overriding,</font><br>
          <strong>AccessFileName .htaccess</strong><br>
          <font color="#0099FF"># and never show them</font><br>
          <strong>&lt;Files ~ &quot;^\.ht&quot;&gt;<br>
          　　　Order allow,deny<br>
          　　　Deny from all<br>
          &lt;/Files&gt;</strong><br>
          <font color="#00FFFF"># <font size="2">這裡是定義存取控制檔案名稱為 .htaccess，且拒絕任何來源端做存取。</font></font><br>
          <br>
          <font color="#0099FF"># List of resources to look for when the client 
          requests a directory</font><br>
          <strong>DirectoryIndex index.html index.html.var</strong><br>
          <font color="#00FFFF"># <font size="2">當 client 端在存取某個目錄而未指定檔名時，則會依序比對</font><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF" size="2"> 
          </font><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">DirectoryIndex</font></font></font><font size="2"> 
          </font></font></font></font></font><font size="2">所列出的</font></font></font></font></font><font color="#FFFFFF"><font color="#00FFFF"><font size="2"><br>
          </font># <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">檔名</font></font></font></font></font><font color="#FFFFFF"><font color="#00FFFF"><font size="2"></font></font></font><font size="2">與該目錄中的檔名有無符合者，</font></font></font></font></font><font size="2">如果有的話，就直接開啟此網頁檔案。</font></font><font size="2"><br>
          </font><br>
          <font color="#0099FF" size="+1"><strong>### 'Main' server configuration 
          ###</strong></font><br>
          <br>
          <font color="#0099FF"># The directives in this section set up the values 
          used by the 'main'<br>
          # server, which responds to any requests that aren't handled by a<br>
          # &lt;VirtualHost&gt; definition. These values also provide defaults 
          for<br>
          # any &lt;VirtualHost&gt; containers you may define later in the file.<br>
          #<br>
          # All of these directives may appear inside &lt;VirtualHost&gt; containers,<br>
          # in which case these default settings will be overridden for the<br>
          # virtual host being defined.</font><br>
          <br>
          <strong>Include /etc/apache2/default-server.conf</strong><br>
          <br>
          <font color="#0099FF" size="+1"><strong>### Virtual server configuration 
          ### </strong></font><br>
          <br>
          <strong>Include /etc/apache2/vhosts.d/*.conf <br>
          </strong><font color="#00FFFF">#<font size="2"> 這裡是說，虛擬主機設定檔可以安置在 vhosts.d 
          目錄中，且檔名需取名為 xxx.conf 才行。</font></font></font></p></td>
    </tr>
  </table>
  <p><strong><font color="#000000" size="+1"><strong><a name="10"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></strong></font> 
    <font size="+1">/etc/apache2/default-server.conf</font></strong><font color="#000000" size="+1"><strong><font size="5"> 
    </font></strong></font></p>
  <table width="100%" border="0">
    <tr> 
      <td height="1218" nowrap bgcolor="#000000"><font color="#FFFFFF">suse:~ 
        #<strong><font color="#FFFF00"> vi /etc/apache2/default-server.conf</font></strong><br>
        <br>
        <strong>ServerName www.paching.com.tw</strong><br>
        <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">此參數是用來識別 
        Apache 自己的主機名稱。</font><br>
        <br>
        <strong>ServerAdmin barry@paching.com.tw</strong><br>
        <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">設定網站管理員的 
        mail 地址。當 web 服務出現錯誤而導致 Client 無法瀏覽網頁時，</font><br>
        <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">可讓 Client 
        透過瀏覽器視窗中，所顯示該管理員 E-mail 的連結，來跟管理員聯繫。 </font><strong><br>
        <br>
        DocumentRoot &quot;/srv/www/htdocs&quot;</strong><br>
        <font color="#00FFFF"># <font size="2">定義網站的根目錄位置。<br>
        </font>#<font size="2"> <font color="#FFFFFF"><font color="#00FFFF">比如 
        Client 所輸入的 URL 為 http://www.domain.com/ ，</font></font>這時候就會至 <br>
        </font># <font size="2"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">/srv/www/htdocs/ 
        </font></font></font><font size="2">目錄中</font></font></font><font size="2">去尋<font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF">找有</font></font></font></font></font></font></font><font color="#00FFFF">無與 
        DirectoryIndex 所定義的檔名相同，</font></font><br>
        </font>#<font size="2"> <font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2"><font color="#FFFFFF"><font color="#00FFFF">只要</font></font>有符合者，就直接開啟該網頁檔案 
        </font></font></font><font size="2">(一般為</font></font></font></font></font></font></font></font></font><font size="2">index.html 
        )<font color="#FFFFFF"><font color="#00FFFF">。</font></font></font></font></font></font></font><font color="#00FFFF">那如果</font></font>URL 
        為 </font></font><br>
        <font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF">#<font size="2"> 
        </font></font></font><font color="#FFFFFF"><font color="#00FFFF"><font size="2"> 
        </font><font color="#FFFFFF"><font color="#00FFFF"><font size="2">http://www.domain.com/test/，則會至</font></font></font><font size="2">/srv/www/htdocs/test/ 
        </font></font></font><font size="2">目錄中去搜尋。 </font><br>
        </font> <br>
        <strong>&lt;Directory &quot;/srv/www/htdocs&quot;&gt; <br>
        　　　Options None<br>
        　　　AllowOverride None<br>
        　　　Order allow,deny<br>
        　　　Allow from all<br>
        &lt;/Directory&gt; </strong><br>
        <font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"># <font size="2">這是有關存取目錄相關權限的設定。<br>
        </font>#<font size="2"> <font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">每個目錄的設定區段是以 
        &lt;Directory &quot;directory-path&quot;&gt; </font></font></font><font color="#00FFFF">做開</font></font>始，而以 
        &lt;/Directory&gt; <br>
        </font><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF">#<font size="2"> 
        </font></font></font><font size="2">做結束。至於設定項目，請接著看以下的說明。<br>
        </font></font></font><font size="2"> </font></font></font><font size="2"><br>
        </font>#<font color="#FF0000" size="2"> </font><font color="#FF0000"><strong>Options</strong></font><font size="2"> 
        之後可接的值有：<br>
        </font># <font size="2">　　<font color="#FFFF00">Indexes</font>：如目錄下，找無 
        DirectoryIndex 所定義的檔名時，則顯示該目錄內容。<br>
        </font># <font size="2">　　<font color="#FFFF00">FollowSymlinks</font>：該目錄下的符號連結檔，允許連結至此目錄外的範圍。<br>
        </font># <font size="2">　　<font color="#FFFF00">ExecCGI</font>：允許在此目錄下執行 
        CGI 程式。<br>
        </font>#<font size="2"> 　　<font color="#FFFF00">MultiViews</font>：可支援多國的語言版本。<br>
        </font># <font size="2">　　<font color="#FFFF00">All</font>：開放所有功能。<br>
        </font># <font size="2">　　<font color="#FFFF00">None</font>：關閉所有功能。<br>
        <br>
        </font>#<strong> <font color="#FF0000">AllowOverride</font></strong><font size="2"><br>
        </font># <font size="2">您可以在每個存取目錄中，去建立一個 .htaccess 的隱藏檔，並且可以讓 .htaccess 
        內<font color="#FFFFFF"><font color="#00FFFF"><font size="2"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF">的</font></font></font></font></font></font></font></font></font><font size="2"><br>
        </font># <font size="2"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">設定項目</font></font></font><font size="2">凌</font></font></font><font color="#00FFFF">駕在這裡的設定之上，不過得先在該目錄區段內使用 
        AllowOverride 去指定</font></font><br>
        </font># <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2"><font color="#FFFFFF"><font color="#00FFFF">才行。以下列出部分於</font></font></font></font></font><font size="2"> 
        AllowOverride 之後可使用的設定項目：</font></font></font><font size="2"><br>
        </font># <font color="#FFFF00" size="2">　　AuthConfig</font><font size="2">：於 
        .htaccess 中對存取目錄做認證方面的設定，會凌駕在這裡設定之上。<br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font size="2">　　<font color="#FFFF00">Limit</font>：於 
        .htaccess 中設定對來源端的存取限制，會凌駕於此處之上。</font><br>
        # </font><font size="2">　　<font color="#FFFF00">Options</font><font color="#00FFFF">：</font></font><font color="#00FFFF" size="2">就是剛剛才介紹的 
        Options 囉。</font><br>
        <font color="#00FFFF"># </font><font size="2">　　<font color="#FFFF00">All</font><font color="#00FFFF">：只要在 
        .htaccess 中所做的任何設定，都會凌駕在這裡的設定之上。</font>　　</font><br>
        <font color="#00FFFF"># </font><font size="2">　<font color="#FFFF00">　None</font><font color="#00FFFF">：AllowOverride 
        設定成 None，表示會忽略 .htaccess 這個檔案。</font></font><br>
        <font color="#00FFFF"><font size="2"><br>
        </font>#<font size="2"><strong> </strong></font><strong><font color="#FF0000">Order 
        allow,deny</font></strong><font size="2"><br>
        </font>#<font color="#FF0000" size="2"> </font><font color="#FF0000"><strong>Allow 
        from all</strong></font><br>
        # <font size="2">設定來源端存取的限制，此處的設定，是表示所有來源端都可以做存取。<br>
        </font>#<font size="2"> 若設定順序為 allow,deny，則最後是以 deny 做為判定的依據。比方您想拒絕少數、允許<br>
        </font># <font color="#FFFFFF"><font color="#00FFFF"><font size="2">多數來源</font></font></font><font size="2">端存取，可以這麼設定：<br>
        </font></font></font> <font color="#00FFFF">#</font><font color="#00FFFF" size="2"> 
        <font color="#FFFF00">order allow,deny</font><br>
        </font><font color="#00FFFF">#<font color="#FFFF00" size="2"> allow from 
        all</font><font size="2"><br>
        </font># <font color="#FFFF00" size="2">deny from 192.168.1 test.com.tw</font><font size="2"><br>
        </font># <font size="2">相反地，若只想允許少數、拒絕多數來源端做存取，則設定如下：<br>
        </font>#<font color="#FFFF00"> <font size="2">order deny,allow</font></font><font size="2"><br>
        </font>#<font size="2"> <font color="#FFFF00">deny from all</font><br>
        </font>#<font size="2"> <font color="#FFFF00">allow from 192.168.0 paching.com.tw</font></font></font><font color="#FFFFFF">&nbsp;</font><font color="#FFFFFF"><br>
        <br>
        <strong>Alias /icons/ &quot;/usr/share/apache2/icons/&quot; <br>
        </strong><font color="#00FFFF"># <font size="2">此處是有關於別名的設定。以這裡來說，icons 
        就是個別名，也就是 Client 端在對 <br>
        </font>#<font size="2"> </font><font color="#FFFFFF"><font color="#00FFFF"><font size="2">icons 
        目錄</font></font></font><font size="2">做存取時，實際上會轉而向 /usr/share/apache2/icons 
        目錄做存取。</font><font size="2"><br>
        </font>#<font size="2"> </font><font size="2">假使沒有為 icons 設定別名時，那麼就會去存取 
        /srv/www/htdocs/icons 目錄。</font></font><strong><br>
        </strong> </font> 
        <p><font color="#FFFFFF"><strong>&lt;Directory &quot;/usr/share/apache2/icons&quot;&gt;<br>
          　　　Options Indexes MultiViews<br>
          　　　AllowOverride None<br>
          　　　Order allow,deny<br>
          　　　Allow from all<br>
          &lt;/Directory&gt;</strong><br>
          <font color="#00FFFF">#<font size="2"> 此目錄區段中的 options 使用了 indexes，那就表示當您對此目錄作存取時，如該目錄中<br>
          </font>#<font size="2"> 並無存在一個與 DirectoryIndex</font></font> <font color="#00FFFF" size="2">所定義的檔名相同時，就會顯示 
          icons 目錄的內容。</font><font color="#00FFFF"><br>
          </font><strong><br>
          ScriptAlias /cgi-bin/ &quot;/srv/www/cgi-bin/&quot;</strong><br>
          <font color="#00FFFF">#<font size="2"> 這裡別名的設定功能，跟剛剛介紹的 Alias 差不多，只是目錄下所存放的檔案類型不同。<br>
          </font># <font size="2">如果您是使用</font></font> <font color="#00FFFF" size="2">ScriptAlias 
          的話，那表示在 /srv/www/cgi-bin 目錄中都是一些 cgi 程式。<br>
          </font><font color="#00FFFF"># <font size="2">簡單的說，cgi-bin <font size="2">就是</font>放置 
          server scripts 的目錄所在，像 Openwebmail ( 網路郵局 ) </font><br>
          # <font size="2">便會使用到該項別名的設定。</font></font></font> <font color="#FFFFFF"><br>
          <br>
          <strong>&lt;Directory &quot;/srv/www/cgi-bin&quot;&gt;<br>
          　　　AllowOverride None<br>
          　　　Options +ExecCGI -Includes<br>
          　　　Order allow,deny<br>
          　　　Allow from all<br>
          &lt;/Directory&gt;</strong><br>
          </font></p></td>
    </tr>
  </table>
  <p><strong><font color="#000000" size="+1"><a name="11"></a></font></strong><strong><font color="#000000" size="+1"><strong><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></strong></font> 
    <font size="+1">/etc/apache2/listen.conf</font></strong></p>
  <table width="100%" border="0">
    <tr> 
      <td nowrap bgcolor="#000000"><font color="#FFFFFF">suse:~ # <strong><font color="#FFFF00">vi 
        /etc/apache2/listen.conf</font><br>
        </strong><br>
        <strong>Listen 80</strong><br>
        <font color="#00FFFF">#<font size="2"> 指定所監聽的介面位址及 port number。而這裡的設定是表示允許在所有的介面位址去<br>
        </font>#<font size="2"> <font color="#FFFFFF"><font color="#00FFFF">監聽 
        </font></font></font><font size="2">80 port。如果您有兩個介面，但只允許其中一個介面位址來監聽，則可設定如下：<br>
        </font>#<font size="2"> Listen 192.168.1.111:80<br>
        </font>#<font size="2"> 如不打算使用這個 well-known port 的話，請逕行修改。比如改成 &quot; 
        Listen 8000 &quot; 之後，<br>
        </font># <font color="#FFFFFF"><font color="#00FFFF"><font size="2">那 
        Client 端就需在</font></font></font> <font size="2">URL 上去指定 8000 port，例: 
        http://www.domain.com:8000/ </font></font></font></td>
    </tr>
  </table>
  <p><strong><font color="#000000" size="+1"><strong><a name="13"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></strong></font> 
    <font size="+1">/etc/apache2/server-tuning.conf</font></strong></p>
  <table width="100%" border="0">
    <tr> 
      <td nowrap bgcolor="#000000"><font color="#FFFFFF">suse:~ # <font color="#FFFF00"><strong>vi 
        /etc/apache2/server-tuning.conf</strong></font><br>
        <br>
        <strong>&lt;IfModule prefork.c&gt;</strong><br>
        <font color="#00FFFF"># <font size="2">表示載入 prefork.c 這個 MPM (multiprocessing 
        module) 模組。</font></font><br>
        　　　<strong>StartServers 5</strong><br>
        　　　<font color="#00FFFF"># <font size="2">Apache 啟動時的服務行程數為 5 個。</font></font><br>
        <br>
        　　　<strong>MinSpareServers 5</strong><br>
        　　　<font color="#00FFFF"># <font size="2">最少需保持 5 個閒置行程數。</font></font><br>
        <br>
        　　　<strong>MaxSpareServers 10</strong><br>
        　　　<font color="#00FFFF"># <font size="2">設定最大的閒置行程數為 10 個。</font></font><br>
        <br>
        　　　<strong>ServerLimit 150 </strong><br>
        　　　<font color="#00FFFF"># <font size="2">限定 MaxClients 的上限。</font></font><br>
        <br>
        　　　<strong>MaxClients 150</strong><br>
        　　　<font color="#00FFFF"># <font size="2">設定最多能同時應付 150 個 Client 端的需求，也就是 
        Server 所能產生的<br>
        </font><font color="#FFFFFF"><font color="#00FFFF">　　　# </font></font><font size="2">最大行程數為 
        150。</font></font><br>
        <br>
        　　　<strong>MaxRequestsPerChild 0</strong><br>
        　　　<font color="#00FFFF"># <font size="2">當</font>「<font size="2">Keep 
        Alive</font>」<font size="2">設定成 off 時，每個子行程所能產生的最大需求數。</font></font><br>
        <br>
        <strong>&lt;/IfModule&gt;</strong><br>
        <br>
        <strong>KeepAlive On </strong><br>
        <font color="#00FFFF"># <font size="2">打開持續連線的功能。</font><br>
        # <font size="2">當KeepAlive 設定成 off 的情況下，一個 connection 就是一個 request，也就是說當<br>
        </font># <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2"> 
        Client </font></font></font> <font size="2">完成一個連線</font></font></font><font size="2">請求後，Server 
        就會馬上切斷連線 ; 那現在要是開啟持續連線功能<br>
        </font>#<font size="2"> <font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">的話，</font></font></font><font color="#00FFFF">在 
        Client 完成連線請求後，</font></font></font><font size="2">Server 並不會馬上斷線，而是要等到所限定的時間<br>
        </font><font color="#FFFFFF"><font color="#00FFFF">#<font size="2"> </font></font></font><font color="#FFFFFF"><font color="#00FFFF"><font size="2">到達時，</font></font></font><font size="2">才會切斷連線。</font></font><br>
        <br>
        <strong>MaxKeepAliveRequests 100</strong><br>
        <font color="#00FFFF"># <font size="2">設定持續連線下的最大需求數。</font></font><br>
        <br>
        <strong>KeepAliveTimeout 15</strong><br>
        <font color="#00FFFF"># <font size="2">在持續連線下，Client 完成連線請求後，若 15 秒內沒有再提出任何的 
        request，則在 15 秒<br>
        </font>#<font size="2"> <font color="#FFFFFF"><font color="#00FFFF">時間到達時，</font></font></font><font size="2">Server 
        就會斷開連線。</font></font></font></td>
    </tr>
  </table>
  <p><strong><font color="#000000" size="+1"><strong><a name="14"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></strong></font> 
    <font size="+1">/etc/apache2/uid.conf</font></strong></p>
  <table width="100%" border="0">
    <tr> 
      <td nowrap bgcolor="#000000"><font color="#FFFFFF">suse:~ # <font color="#FFFF00"><strong>vi 
        /etc/apache2/uid.conf</strong></font><strong><br>
        User wwwrun<br>
        Group www</strong><br>
        <font color="#00FFFF">#</font><font color="#00FFFF" size="2"> Apache 服務啟動時，是以 
        root 的身分來啟動主要控制程式 httpd2-prefork，然後再以 <br>
        </font><font color="#00FFFF"># </font><font color="#FFFFFF"><font color="#00FFFF" size="2">wwwrun 
        帳號去</font></font><font color="#00FFFF" size="2">執行其下的子行程</font><font color="#00FFFF" size="2">。</font></font></td>
    </tr>
  </table>
  <p> <strong><font color="#000000" size="+1"><strong><a name="15"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></strong></font> 
    <font size="+1">/etc/apache2/mod_userdir.conf<br>
    <br>
    </font></strong>　這是有關使用者個人網頁的相關設定，包括個人網頁的根目錄位置、存取權限的控管等。<strong><font size="+1"> 
    </font></strong></p>
  <table width="100%" border="0">
    <tr> 
      <td nowrap bgcolor="#000000"><font color="#FFFFFF">suse:~ #<strong> <font color="#FFFF00">vi 
        /etc/apache2/mod_userdir.conf</font></strong><br>
        <br>
        <strong>&lt;IfModule mod_userdir.c&gt;</strong><br>
        <br>
        　　　<strong>UserDir disabled root</strong><br>
        　　　<font color="#00FFFF"># <font size="2">不開放存取 root 的個人網頁。</font><br>
        　　　# <font size="2">如果您只是不允許 Client 瀏覽 root、barry</font></font></font><font color="#00FFFF" size="2">、mary 
        的網頁，那麼可以這樣設定：</font><font color="#00FFFF"><br>
        　　　# <font color="#FFFF00" size="2"><strong>UserDir disabled root barry 
        mary</strong></font><br>
        　　　# <font size="2">相反過來，如果只允許瀏覽 barry 及 mary 的網頁，其他都拒絕，則請設定如下：</font><br>
        　　　# <font color="#FFFF00" size="2"><strong>UserDir disabled</strong></font><br>
        　　　#<strong> <font color="#FFFF00" size="2">UserDir enabled barry mary</font></strong><br>
        <br>
        　　　# <font size="2">最後談到開放 root 個人網頁的做法：</font><br>
        　　　#<font size="2"> 1. 將 &quot; UserDir disabled root &quot; 註解起來。</font><br>
        　　　# <font size="2">2. 對 /root/public_html 這個目錄區段做相關存取權限的設定。<br>
        </font>　　　#　<font color="#FFFF00" size="2">&lt;Directory /root/public_html&gt;</font><br>
        　　　#　　　<font color="#FFFF00" size="2">Order allow,deny</font><br>
        　　　#　　　<font color="#FFFF00">Allow from all</font><br>
        　　　#　<font color="#FFFF00" size="2">&lt;/Directory&gt;</font><font color="#FFFF00">　</font>　　<br>
        　　　# <font size="2">3. 確定 <font color="#00FFFF">others</font> 對</font> 
        <font size="2">/root 及 /root/public_html 目錄，具有可執行的權限。</font></font><font color="#FFFFFF"><font size="2"><br>
        </font><br>
        　　　#<strong> UserDir public_html </strong><br>
        　　　<font color="#00FFFF"># <font size="2">設定使用者個人網頁所存放的根目錄名稱，預設為 public_html。意思就是說，個人<br>
        </font>　　　# <font color="#FFFFFF"><font color="#00FFFF"><font size="2">網頁必須存放</font></font></font><font size="2">在自己家目錄下的 
        public_html 目錄之中。</font><br>
        <br>
        　　　# <font size="2">當 Client 端要瀏覽某個使用者的個人網頁時，必須在 URL 使用 &quot; ~username 
        &quot; </font><br>
        　　　# <font color="#FFFFFF"><font color="#00FFFF"><font size="2">去指定。</font></font></font><font size="2">以存取使用者 
        barry 的個人網頁來說，則 Client 端需輸入網址：<br>
        </font>　　　# <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">http://www.domain.com/~barry/</font></font></font></font></font><font size="2">。</font><br>
        <br>
        　　　# <font size="2">當然這個根目錄名稱可以做修改，比如由 public_html 改成 userweb 之後，那麼</font><br>
        　　　# <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">家目錄中就必須存</font></font></font><font size="2">在</font></font></font> 
        <font size="2">userweb 這個目錄 ; 另外您還需對這個目錄做存取權限</font><br>
        　　　<font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
        </font></font><font color="#00FFFF" size="2">方面的設定，只要把底下</font><font size="2"><font color="#00FFFF">的目錄區段中</font> 
        <font color="#FFFFFF"><font color="#00FFFF">&lt;Directory /home/*/public_html&gt;</font></font></font> 
        <font color="#00FFFF" size="2">裡的</font></font><br>
        　　　# </font></font> <font color="#00FFFF" size="2"> public_html 改成 userweb 
        即可。</font><font color="#FFFFFF" size="2"><br>
        </font><font color="#FFFFFF">　　　<br>
        　　　&lt;Directory /home/*/public_html&gt; 
        <p> 　　　　　　AllowOverride FileInfo AuthConfig Limit Indexes<br>
          　　　　　　Options MultiViews Indexes SymLinksIfOwnerMatch </p>
        <p> 　　　　　　&lt;Limit GET POST OPTIONS PROPFIND&gt;<br>
          　　　　　　　　　Order allow,deny<br>
          　　　　　　　　　Allow from all<br>
          　　　　　　&lt;/Limit&gt;</p>
        <p> 　　　　　　&lt;LimitExcept GET POST OPTIONS PROPFIND&gt;<br>
          　　　　　　　　　Order deny,allow<br>
          　　　　　　　　　Deny from all<br>
          　　　　　　&lt;/LimitExcept&gt;</p>
        </font> <p><font color="#FFFFFF"> 　　　&lt;/Directory&gt;<br>
          <br>
          <strong>&lt;/IfModule&gt; <br>
          </strong><font color="#00FFFF"># <font size="2">這裡解釋一下 Limit 的用法，Limit 
          主要是對來源端的存取動作做進一步限定，比如 </font><br>
          #<font size="2"> GET, POST, PUT,DELETE, CONNECT, OPTIONS, PATCH,&#8230;等等。舉個例子，假使您想<br>
          </font># <font size="2">拒絕 192.168.2.0/24 的來源端瀏覽網頁，並只允許192.168.3.0/24 
          的來源端張貼資料，<br>
          </font># </font><font color="#00FFFF" size="2">那麼可設定如下： </font></font> 
          <font color="#00FFFF"><br>
          # <font size="2">&lt;Limit GET&gt;</font></font> <font color="#00FFFF"><br>
          # <font size="2">　　Order allow,deny</font></font> <font color="#00FFFF"><br>
          # <font size="2">　　Allow from all </font></font> <font color="#00FFFF"><br>
          # <font size="2">　　Deny from 192.168.2</font></font> <font color="#00FFFF"><br>
          # <font size="2">&lt;/Limit&gt;</font></font> <font color="#00FFFF"><br>
          #<br>
          # <font size="2">&lt;Limit POST&gt;</font><br>
          #<font size="2">　　 Order deny,allow</font><br>
          #<font size="2">　　 Deny from all <br>
          </font>#<font size="2">　　 Allow from 192.168.3.0/24</font></font><font color="#00FFFF" size="2"> 
          <br>
          </font><font color="#00FFFF">#</font> <font color="#00FFFF" size="2">&lt;/Limit&gt;</font><font color="#00FFFF"> 
          <font size="2">　　　</font></font><font color="#00FFFF" size="2">　　　 　　</font><font color="#FFFFFF" size="2">　　　　</font><font color="#FFFFFF"><strong><br>
          </strong></font></p></td>
    </tr>
  </table>
  <p> 　Apache 的相關組態檔就大致如此。完成設定之後，第一次啟動 Apache，請使用以下任何一種方式來執行： </p>
  <table width="100%" border="0" bgcolor="#000000">
    <tr> 
      <td><font color="#FFFFFF">suse:~ # <strong><font color="#FFFF00">/etc/init.d/apache2 
        start</font></strong><br>
        suse:~ #<strong> <font color="#FFFF00">rcapache2 start</font></strong><br>
        suse:~ #<strong> <font color="#FFFF00">apache2ctl start </font></strong></font></td>
    </tr>
  </table>
  <p> 　另外您也可以利用以下兩種方式，來測試一下設定語法有無問題：</p>
  <table width="100%" border="0">
    <tr> 
      <td bgcolor="#000000"><font color="#FFFFFF">suse:~ # <strong><font color="#FFFF00">apache2ctl 
        configtest</font></strong><br>
        Syntax OK<br>
        suse:~ # <strong><font color="#FFFF00">httpd2 -t</font></strong><br>
        Syntax OK</font></td>
    </tr>
  </table>
  <p> <font color="#000000" size="+1"><strong><a name="16" id="16"></a><font size="5">16.3.2 
    </font></strong></font><font size="5"><strong>建立使用者個人網頁</strong></font><font size="+1"><br>
    </font><br>
    　這裡我們以建立使用者 barry 的個人網頁為例，來看看要怎麼做：</p>
  <table width="100%" border="0">
    <tr> 
      <td bgcolor="#000000"><font color="#00FFFF" size="2">1. 確定 public_html 目錄有存在於 
        barry 家目錄下，如不存在，請自行建立：</font><font color="#FFFFFF"><br>
        barry@suse:~&gt;<font color="#FFFF00"><strong> ls</strong></font><br>
        <font color="#0099FF">Documents　bin<strong>　public_html </strong></font><br>
        <br>
        <font color="#00FFFF" size="2">2. 建立 index.html 檔案於 public_html 目錄中：</font><br>
        barry@suse:~/public_html&gt;<strong><font color="#FFFF00"> cat &gt;</font></strong><font color="#FFFF00"><strong> 
        index.html</strong></font><br>
        Welcome to barry's Web site. <br>
        <strong><br>
        </strong><font color="#00FFFF" size="2">3. 檢查相關目錄的權限：</font><br>
        barry@suse:~&gt; <font color="#FFFF00"><strong>ls -ld ; ls -ld public_html 
        </strong></font><br>
        drwxr-xr-x　7　barry　users　560　Nov 17 04:46　.<br>
        drwxr-xr-x　2　barry　users　144　Nov 17 04:54　public_html<br>
        <font color="#00FFFF"> # <font size="2">請務必確定<font color="#FFFFFF"><font color="#00FFFF"> 
        others </font></font>對家目錄及 public_html，具有可執行的權限。</font></font></font></td>
    </tr>
  </table>
  <p> 　完成後，請回到 Client 端測試看看：</p>
  <p align="center"> <img src="apache2.png" tppabs="http://www.suse.url.tw/picture/apache2.png" width="528" height="269"> 
  </p>
  <p>　<br>
    <strong><font color="#000000" size="+1"><strong><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></strong></font></strong> 
    <font color="#000000" size="4"><strong>以 username 存取個人網頁</strong></font><br>
    <br>
    　在存取個人網頁時，都要在 username 之前加上個「~」符號，如果這樣您嫌麻煩，而想直接輸入 username 就可以開啟網頁的話，那麼提供兩種做法給您參考 
    ( 以 barry 為例 )：</p>
</div>
<ol>
  <li> 
    <div align="left"><strong>設定 barry 的別名</strong>：<br>
      <br>
      <table width="70%" border="0">
        <tr> 
          <td height="75" bgcolor="#000000"><font color="#FFFFFF">suse:/etc/apache2 
            # <font color="#FFFF00"><strong>vi default-server.conf</strong></font><br>
            Alias　/barry/　&quot;/home/barry/public_html/&quot;<br>
            <br>
            suse:~ #<font color="#FFFF00"><strong> rcapache2 restart</strong></font> 
            </font></td>
        </tr>
      </table>
      <br>
      這樣當您所輸入的 URL 為「http://192.168.1.111/barry/」時，就會轉而向 /home/barry/public_html/ 
      目錄做存取。 <br>
      <br>
    </div>
  </li>
  <li> 
    <div align="left"><strong>建立符號連結檔</strong>：<br>
      <br>
      <table width="70%" border="0">
        <tr> 
          <td height="215" bgcolor="#000000"><font color="#FFFFFF">suse:/srv/www/htdocs 
            # <strong><font color="#FFFF00">ln -s /home/barry/public_html barry</font></strong><br>
            <br>
            suse:/etc/apache2 #<font color="#FFFF00"><strong> vi default-server.conf</strong></font><br>
            &lt;Directory &quot;/srv/www/htdocs&quot;&gt;　　　　<br>
            　　　Options <font color="#FFFF00">FollowSymLinks</font>　　　　<br>
            　　　AllowOverride None　　　　<br>
            　　　Order allow,deny <br>
            　　　Allow from all<br>
            &lt;/Directory&gt; <br>
            <font color="#00FFFF"># <font size="2"> <font color="#00FFFF" size="2">Options 
            的部分請修改成 FollowSymLinks，這樣才能讓 /srv/www/htdocs/barry <br>
            </font></font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font size="2"><font color="#00FFFF" size="2">這個符號連結檔，能連結到此目錄以外的地方。</font></font></font> 
            <br>
            <br>
            suse:~ #<font color="#FFFF00"><strong> rcapache2 restart</strong></font> 
            </font></td>
        </tr>
      </table>
    </div>
  </li>
</ol>
<div align="left">
  <p>　不論您是採用以上的哪種方式，請於修改完成後測試看看：</p>
  <p align="center"> <img src="apache3.png" tppabs="http://www.suse.url.tw/picture/apache3.png" width="528" height="269"> 
  </p>
  <p><br>
    <font color="#0000FF" size="+1"><strong><a name="17"></a><font size="6">16.4 
    設定認證目錄及 .htaccess 的使用 </font></strong></font><br>
    <br>
    <font size="+1"><strong><a name="18"></a><font size="5">16.4.1 認證目錄</font></strong></font><br>
    <br>
    　有時候一些比較特殊的網頁，您不希望每個人都可以存取，這時候可以將這些網頁檔案放置在指定的目錄之中，然後對此目錄做認證方面的設定，這樣當使用者在開啟網頁時，就會跳出一個認證的視窗，來要求您輸入帳號密碼，等認證通過以後，方可存取。<br>
    <br>
    　假使現在要做一個認證目錄叫 specialdir，接著就來看看要如何做相關的設定：</p>
  <table width="100%" border="0">
    <tr> 
      <td nowrap bgcolor="#000000"><p><font color="#FFFFFF"><font color="#00FFFF" size="2">1. 
          先建立認證目錄</font><font color="#00FFFF">：</font><br>
          suse:/srv/www/htdocs #<strong> <font color="#FFFF00">mkdir specialdir</font></strong><br>
          suse:/srv/www/htdocs # <strong><font color="#FFFF00">cat &gt; specialdir/index.html</font></strong><br>
          Congratulations on passing this authentication.　<br>
          <font color="#00FFFF"><br>
          <font size="2">2. 設定認證目錄</font>：</font><br>
          suse:~ #<strong> <font color="#FFFF00">vi /etc/apache2/default-server.conf 
          </font></strong><br>
          <br>
          &lt;Directory &quot;/srv/www/htdocs/specialdir&quot;&gt;<br>
          　　　AuthName &quot;It is top secret&quot; <font color="#00FFFF">　<br>
          　　　# <font size="2">這只是宣告認證的領域 (範圍) 而已。</font></font><br>
          <br>
          　　　AuthType basic 　<font color="#00FFFF"><br>
          　　　# <font size="2">設定認證的類型。目前有 basic 及 Digest 可供使用。</font></font><br>
          <br>
          　　　AuthUserFile &quot;/etc/authfile&quot; 　<font color="#00FFFF"><br>
          　　　# <font size="2">指定使用者做認證時，所要依據的認證檔案。</font></font><br>
          <br>
          　　　require valid-user 　<br>
          <font color="#00FFFF">　　　</font><font color="#00FFFF"># <font size="2">這行設定是說，在認證檔案中的使用者都是有效的使用者。當然您也<font color="#FFFFFF"><font color="#00FFFF">可以指定</font></font><br>
          </font>　　　# <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">只允許哪些人來</font></font></font></font></font><font size="2">做認證，比如 
          &quot; require user barry mary &quot;，這</font><font color="#FFFFFF"><font color="#00FFFF"><font size="2">樣就只有<br>
          </font><font color="#FFFFFF"><font color="#00FFFF">　　　# </font></font><font size="2">barry 
          及 mary 可以對認證目錄做存取。</font></font></font>　　　　　　　 　</font><br>
          &lt;/Directory&gt;<strong> <br>
          </strong> <br>
          <font size="2"><font color="#00FFFF">3. 重新啟動 Apache：</font><br>
          </font>suse:~ #<strong><font color="#FFFF00"> rcapache2 
          restart</font><br>
          </strong> <br>
          <font size="2"><font color="#00FFFF">4. 建立使用者認證資料</font></font><font color="#00FFFF">：</font><br>
          suse:~ # <strong><font color="#FFFF00">htpasswd2 -c /etc/authfile david</font></strong><br>
          New password:<br>
          Re-type new password:<br>
          Adding password for user david<br>
          </font><font color="#FFFFFF"><font color="#00FFFF"> <font color="#FFFFFF"><font color="#00FFFF"># 
          </font></font><font size="2">如 /etc/authfile 原本不存在，可使用 -c (create) 參數來將其建立起來 
          ; 但如果這個檔案<br>
          </font><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
          </font></font></font></font><font color="#FFFFFF"><font color="#00FFFF"><font size="2">原本已存在，</font></font></font><font size="2">則不需加上此參數，萬一不小心加了，反而會覆蓋掉原先的認證資料，這點請注意。<br>
          </font><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
          </font></font></font></font></font></font><font size="2">另外要刪除某個使用者的認證資料時，可把 
          &quot; -c &quot; 參數改成 &quot; -D &quot; 即可，不然也可以直接<br>
          </font><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
          </font></font></font></font></font></font></font></font><font size="2">編輯 
          /etc/authfile，將該使用者的資料直接移除。</font></font></font></p></td>
    </tr>
  </table>
  <p><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"> 
    Client 端測試</font></strong></p>
  <p>　請於 URL 上輸入 http://192.168.1.111/specialdir/：</p>
  <p align="center"> <img src="apache4.png" tppabs="http://www.suse.url.tw/picture/apache4.png" width="582" height="364"> 
  </p>
  <p> 　認證通過後，就會看到網頁的內容啦：</p>
  <p align="center"> <img src="apache5.png" tppabs="http://www.suse.url.tw/picture/apache5.png" width="583" height="366"></p>
  <p> <font size="+1"><strong><a name="19"></a><font size="5">16.4.2 .htaccess 
    的使用</font></strong></font><br>
    <br>
    　在 16.3.1 小節中提及 /etc/apache2/default-server.conf 時，於介紹 <a href="#100">AllowOverride 
    </a>中有提到 .htaccess 的功用，由那個地方的說明，不難看出 .htaccess 必須要靠 AllowOverride 的指派，才能讓 
    .htaccess 檔案裡所設定的項目，能夠凌駕在 Apache 設定檔中該目錄區段的設定項目之上。<br>
    <br>
    　 說到這裡，可能您還不是很明白什麼時候會使用到 .htaccess ，舉個例子好了，假使今天有個使用者 barry，要求管理者幫其做個人網頁認證方面的設定，或要求對來源端的存取做進一步的控管等等，那此時管理者需做如下的設定：</p>
  <table width="100%" border="0">
    <tr> 
      <td bgcolor="#000000"><font color="#FFFFFF">suse:~ #<font color="#FFFF00"><strong> 
        vi /etc/apache2/mod_userdir.conf</strong></font><br>
        &lt;Directory &quot;/home/barry/public_html&quot;&gt;<br>
        　　　Options FollowSymLinks<br>
        　　　AuthName &quot;Barry's Web Site&quot;<br>
        　　　AuthType basic<br>
        　　　AuthUserFile &quot;/etc/barryauth&quot;<br>
        　　　require valid-user<br>
        　　　Order allow,deny<br>
        　　　Allow from all<br>
        　　　Deny from 192.168.2.0/24 domain.com.tw<br>
        &lt;/Directory&gt; <br>
        <br>
        suse:~ # <font color="#FFFF00"><strong>rcapache2 restart</strong></font><br>
        <br>
        <font color="#00FFFF"># </font><font color="#00FFFF" size="2">接著幫 barry 
        建立其所提供使用者的認證資料，以 user01 做代表：</font><br>
        suse:~ # <font color="#FFFF00"><strong>htpasswd2 -c /etc/barryauth user01</strong></font><br>
        New password:<br>
        Re-type new password:<br>
        Adding password for user user01 　　　</font></td>
    </tr>
  </table>
  <p> 　這樣就搞定使用者 barry 的要求了。但試想一下，如果今天有好幾十個使用者都向您提出同樣的要求，且每個使用者所提供給您的認證名單都不在少數的話，那這下子可就有得忙了。要解決這個難題，AllowOverride 
    就派得上用場囉。<br>
    <br>
    　管理者只需在設定檔內做好 AllowOverride 的相關設定，就可以 [授權] 給每個使用者自行建立起 .htaccess 這個檔案，並依照自己的需求去做相關控管項目的設定。<br>
    <br>
    　所以簡單的說，管理者先搞定 AllowOverride，然後再讓使用者自己去建立 .htaccess，並於該檔案內依照使用者自己的要求來做設定，而不必靠管理者幫他們一個個處理，如此便減輕很多管理者的負擔。詳細做法，請參考以下的範例說明。<br>
    <br>
    <strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font> 
    <font size="4">管理者的設定</font></strong></p>
  <table width="100%" border="0">
    <tr> 
      <td bgcolor="#000000"><font color="#FFFFFF">suse:~ # <strong><font color="#FFFF00">vi 
        /etc/apache2/mod_userdir.conf</font></strong><br>
        <font face="細明體">&lt;Directory /home/*/public_html&gt; <br>
        　　　AllowOverride AuthConfig Limit options<br>
        　　　Order allow,deny<br>
        　　　Allow from all<br>
        &lt;/Directory&gt; </font><strong><br>
        <br>
        </strong>suse:~ # <strong><font color="#FFFF00">rcapache2 restart</font> 
        </strong></font></td>
    </tr>
  </table>
  <p> 　這個目錄區段的設定，是要讓每個一般使用者，都能夠在自己家目錄下的 public_html 目錄中，去自行設定相關控管項目於 .htaccess 
    檔案內，比如使用者認證的設定、來源端的限制及 options 項目等。<br>
    <br>
    　如果您想把所有設定項目，全部授權給使用者自己搞定的話，可設定 &quot;AllowOverride All&quot;，那如果只允許給使用者做認證方面設定的話，則只需指定 
    &quot;AllowOverride AuthConfig&quot;。 </p>
  <p><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font> 
    <font size="4">使用者的設定</font></strong></p>
  <table width="100%" border="0">
    <tr> 
      <td bgcolor="#000000"><font color="#FFFFFF">barry@suse:~/public_html&gt;<strong> 
        <font color="#FFFF00">vi .htaccess</font></strong><br>
        <br>
        Options FollowSymLinks Indexes<br>
        <br>
        AuthName &quot;Barry's Web Site&quot;<br>
        AuthType basic<br>
        AuthUserFile &quot;/home/barry/authfile&quot;<br>
        require user tom tina<br>
        <br>
        &lt;Limit GET&gt;<br>
        　　　Order allow,deny<br>
        　　　Allow from all<br>
        　　　Deny from 192.168.2 192.168.5<br>
        &lt;/Limit&gt; 
        <p>&lt;Limit POST&gt;<br>
          　　　Order deny,allow<br>
          　　　Deny from all<br>
          &lt;/Limit&gt;<br>
          <br>
          barry@suse:~&gt;<strong> <font color="#FFFF00">/usr/sbin/htpasswd2 -c 
          authfile tom</font></strong><br>
          New password:<br>
          Re-type new password:<br>
          Adding password for user tom<br>
          <br>
          barry@suse:~&gt; <strong><font color="#FFFF00">/usr/sbin/htpasswd2 authfile 
          tina</font></strong><br>
          New password:<br>
          Re-type new password:<br>
          Adding password for user tina </p>
        </font></td>
    </tr>
  </table>
  <p> <br>
    <strong><font color="#0000FF" size="+1"><a name="20"></a><font size="6">16.5 
    </font></font></strong> <font size="6"><strong><font color="#0000FF">虛擬主機的設定</font></strong></font><br>
    <br>
    <font size="+1"><strong><a name="21"></a><font size="5">16.5.1 虛擬主機概述</font></strong></font><br>
    <br>
    　一般來說，當 Client 端輸入不同的網址時，可以個別存取不同主機所提供的網站服務，那當然所瀏覽到的網頁內容都是不一樣的。今天如果提供網頁服務的主機只有一台，而當 
    Internet 的使用者輸入不同的網址時，都是指到這台主機，並且開啟不同的網頁內容，也就是說主機上存在著一個以上的網站，此時站在使用者的角度來看，會以為這些網頁分別存在於不同主機上面，但實際上卻是指向同一部主機。至於如何辦到的，這就是現在要探討的虛擬主機的設定了。<br>
    　<br>
    　不過這裡有個附帶條件，就是必須要能解析得出主機名稱所對應的 IP 位址才行，不管是請別人幫您代指或者自己架設 DNS 都行，反正只要能解析得出來都可以。<br>
    <br>
    　一般虛擬主機有兩種類型：</p>
  <table width="100%" border="0">
    <tr> 
      <td width="2%">&nbsp;</td>
      <td width="3%" align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td width="95%"><strong><font color="#000099">IP-based Virtual Hosts</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td>此為早期在 Apache 上所設定的虛擬主機方式，每個虛擬主機名稱都有其各自的 IP 位址，可能的實施方式就是一台主機放多片網卡，或者用 
        IP Alias 的做法綁多個 IP，但是不管怎麼做，都還是要申請幾個 public IP 才行，那萬一要是 IP 不足的話，可就會壞了大事，於是後來才又發展出 
        Name-based Virtual Hosts。</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">Name-based Virtual Hosts </font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td>將所有的虛擬主機都架設在同一個 IP 位址，也就是把那些虛擬主機名稱都對應到同一個 IP 位址啦。比如我有一個合法的 IP 為 1.2.3.4，並且擁有兩個主機名稱分別為 
        barry.paching.com.tw 及 mary.pachng.com.tw，那麼這時候就需要讓這兩個 FQDN 在 Internet 
        上都能解析得出是對應到 1.2.3.4，這樣就是以名稱為基礎的虛擬主機囉。</td>
    </tr>
  </table>
  <p> <font size="+1"><strong><a name="22"></a><font size="5">16.5.2 設定虛擬主機</font></strong></font><br>
    <br>
    　以下的設定範例，是以 Name-based 為基礎來做設定的。如目前您還未申請 domain name 的話也沒關係，可以自行在區網內模擬出這樣的環境，而待會兒的介紹，就是以區網的環境來說明。<br>
    <br>
    　以我的網路架構來說， Apache 主機的位址是 192.168.1.111，DNS 為 192.168.1.197，其他都是屬於 Windows 
    的 Client 端：</p>
  <p align="center"> <img src="apache6.png" tppabs="http://www.suse.url.tw/picture/apache6.png" width="263" height="221"> 
  </p>
  <p> 　接著做以下的規劃：</p>
  <table width="100%" border="0">
    <tr> 
      <td width="2%">&nbsp;</td>
      <td width="3%" align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td width="95%"><strong><font color="#000099">DNS 部分</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td><table width="100%" border="0">
          <tr> 
            <td width="3%" align="center" valign="top">1.</td>
            <td width="97%">DNS 所管理的 zone 為 paching.com.tw。</td>
          </tr>
          <tr> 
            <td align="center" valign="top">2.</td>
            <td>於 zone file 裡設定 www.paching.com.tw 所對應的 IP 位址為 192.168.1.111，另外 
              barry.paching.com.tw 及 virtual.paching.com.tw 這兩個 FQDN，請使用 CNAME 
              來指向 www.paching.com.tw。</td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">Apache 部分</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td><table width="100%" border="0">
          <tr> 
            <td width="3%" align="center" valign="top">1.</td>
            <td width="97%">原網站的 hostname 為 www.paching.com.tw。</td>
          </tr>
          <tr> 
            <td align="center" valign="top">2.</td>
            <td>virtual.paching.com.tw 這個網站的&nbsp;Home Page 內容為「It's a virtual 
              host.」。</td>
          </tr>
          <tr> 
            <td align="center" valign="top">3.</td>
            <td>barry.paching.com.tw 是使用者 barry 的個人網站，其 Home Page 內容為「barry's 
              web site.」。另外請以 barry 的身分去做認證方面的設定，並指定只有使用者 tom 及 mary 方能透過認證來存取。 
            </td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">Client 端部分</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td>指定其所使用的預設名稱伺服器為 192.168.1.197。</td>
    </tr>
  </table>
  <p> 　再來就分別看看以上三個部分要如何做設定：</p>
  <p><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"> 
    </font><font size="4">設定 DNS</font></strong> <strong>(192.168.1.197)</strong></p>
  <table width="100%" border="0">
    <tr> 
      <td width="2%" align="center" valign="top" nowrap>&nbsp;</td>
      <td width="2%" align="center" valign="middle" nowrap><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td width="96%"><font color="#000099"><strong>設定 named.conf</strong></font></td>
    </tr>
    <tr> 
      <td align="center" valign="top" nowrap>&nbsp;</td>
      <td align="center" valign="middle" nowrap>&nbsp;</td>
      <td><table width="80%" border="0">
          <tr> 
            <td bgcolor="#000000"><font color="#FFFFFF">DNS:~ # <font color="#FFFF00"><strong>vi 
              /etc/named.conf</strong></font><br>
              <font color="#00FFFF" size="2">// 補上以下這個 zone 的宣告即可。</font><br>
              <font face="細明體">zone &quot;paching.com.tw&quot;　in　{<br>
              　　　type master;<br>
              　　　file &quot;master/paching.com.tw.db&quot;;<br>
              }; </font></font></td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td align="center" valign="top" nowrap>&nbsp;</td>
      <td align="center" valign="middle" nowrap>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td align="center" valign="top" nowrap>&nbsp;</td>
      <td align="center" valign="middle" nowrap><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">設定 zone file</font></strong></td>
    </tr>
    <tr> 
      <td align="center" valign="top" nowrap>&nbsp;</td>
      <td align="center" valign="middle" nowrap>&nbsp;</td>
      <td><table width="80%" border="0">
          <tr> 
            <td nowrap bgcolor="#000000"><font color="#FFFFFF">DNS:~ #<font color="#FFFF00"><strong> 
              vi /var/lib/named/master/paching.com.tw.db</strong></font><br>
              <font face="細明體">$TTL 43200</font></font><font color="#FFFFFF" face="細明體"><br>
              @　　　　IN　　SOA　　dns.paching.com.tw.　admin.paching.com.tw.　(<br>
              　　　　　 2006122801 10800 2700 864000 86400　)<br>
              　　　　 IN　　NS　 　dns.paching.com.tw.<br>
              dns　　　IN　　A　　　192.168.1.197<br>
              www　　　IN　　A 　 　192.168.1.111<br>
              virtual　IN　　CNAME　www<br>
              barry　　IN　　CNAME　www</font></td>
          </tr>
        </table></td>
    </tr>
    <tr>
      <td align="center" valign="top" nowrap>&nbsp;</td>
      <td align="center" valign="middle" nowrap>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td align="center" valign="top" nowrap>&nbsp;</td>
      <td align="center" valign="middle" nowrap><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">啟動 named</font></strong></td>
    </tr>
    <tr> 
      <td align="center" valign="top" nowrap>&nbsp;</td>
      <td align="center" valign="middle" nowrap>&nbsp;</td>
      <td><table width="100%" border="0" bgcolor="#000000">
          <tr> 
            <td height="25"><font color="#FFFFFF">DNS:~ #<font color="#FFFF00"> 
              <strong>rcnamed start</strong></font></font></td>
          </tr>
        </table></td>
    </tr>
  </table>
  <p><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font> 
    <font size="4">設定虛擬主機 </font>(192.168.1.111)</strong><strong> </strong></p>
  <table width="100%" border="0">
    <tr> 
      <td width="2%">&nbsp;</td>
      <td width="2%" align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td width="96%"><font color="#000099"><strong>建立 virtual.paching.com.tw 
        的根目錄及首頁 (Home Page)</strong></font></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td><table width="80%" border="0">
          <tr> 
            <td nowrap bgcolor="#000000"><font color="#FFFFFF">Apache</font><font color="#FFFFFF">:~ 
              #<strong> <font color="#FFFF00">mkdir /srv/www/virtualdir</font></strong>　<br>
              Apache:~ # <strong><font color="#FFFF00">cd /srv/www/virtualdir</font></strong><br>
              Apache:/srv/www/virtualdir #<strong> <font color="#FFFF00">cat &gt; 
              index.html</font></strong>　</font><font color="#FFFFFF"><br>
              It's virtual host.</font></td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">建立 barry.paching.com.tw 的 Home Page 及認證設定</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td><table width="80%" border="0">
          <tr> 
            <td nowrap bgcolor="#000000"><font color="#FFFFFF">barry@Apache:~/public_html&gt; 
              <font color="#FFFF00"><strong>cat &gt; index.html</strong></font><br>
              barry's web site.<br>
              <br>
              barry@Apache:~/public_html&gt;<strong><font color="#FFFF00"> vi 
              .htaccess</font></strong><br>
              AuthName &quot;AUTH&quot;<br>
              AuthType basic<br>
              AuthUserFile &quot;/home/barry/authfile&quot;<br>
              require user tom mary <br>
              <br>
              barry@Apache:~&gt;<strong><font color="#FFFF00"> /usr/sbin/htpasswd2 
              -c authfile tom</font></strong><br>
              New password:<br>
              Re-type new password:<br>
              Adding password for user tom<br>
              <br>
              barry@Apache:~&gt; <font color="#FFFF00"><strong>/usr/sbin/htpasswd2 
              authfile mary</strong></font><br>
              New password:<br>
              Re-type new password:<br>
              Adding password for user mary </font></td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">設定 listen.conf</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td><table width="80%" border="0">
          <tr> 
            <td bgcolor="#000000"><font color="#FFFFFF"> Apache:~ # <font color="#FFFF00"><strong>vi 
              /etc/apache2/listen.conf </strong></font><br>
              <br>
              NameVirtualHost 192.168.1.111:80<br>
              <font color="#00FFFF"># <font size="2">這是虛擬主機所監聽的介面位址及 port number 
              。</font></font></font> <br> <font color="#FFFFFF"><font color="#00FFFF"># 
              <font color="#00FF00" size="2">如您採用的是 IP-Based Virtual Host，則此處<font color="#FFFFFF"><font color="#00FFFF">不</font></font></font><font color="#00FF00" size="2">需設定。</font></font></font> 
            </td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">至 vhosts.d 目錄下建立 virtual.conf 檔案，並作如下的設定</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td><table width="80%" border="0">
          <tr> 
            <td nowrap bgcolor="#000000"><font color="#FFFFFF">Apache:~ # <strong><font color="#FFFF00">cd 
              /etc/apache2/vhosts.d</font></strong><br>
              Apache:/etc/apache2/vhosts.d # <strong><font color="#FFFF00">vi 
              virtual.conf </font></strong><br>
              <br>
              &lt;VirtualHost 192.168.1.111:80&gt;<br>
              　　　DocumentRoot &quot;/srv/www/htdocs&quot;<br>
              　　　ServerName www.paching.com.tw:80<br>
              &lt;/VirtualHost&gt;<strong> <br>
              </strong><font color="#00FFFF"># <font size="2">上面的設定是說，當 Client 
              端所輸入的主機名稱是 www.paching.com.tw 時，<br>
              </font>#<font size="2"> <font color="#FFFFFF"><font color="#00FFFF">就等於是對</font></font></font> 
              <font size="2">/srv/www/htdocs 這個根目錄做存取。</font></font><strong><br>
              </strong><font color="#00FFFF"># <font size="2">另外要注意的是啟用 name-based 
              之虛擬主機功能時，若未把原先網站的根目錄<br>
              </font># <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">及主機名稱</font></font></font><font size="2">設定進來，反而會</font></font></font><font size="2">造成無法</font></font></font><font color="#00FFFF" size="2">存取</font></font><font size="2"> 
              /srv/www/htdocs</font></font></font><font size="2">。</font></font><strong><br>
              </strong> 
              <p>&lt;VirtualHost 192.168.1.111:80&gt;<br>
                　　　DocumentRoot &quot;/srv/www/virtualdir&quot;<br>
                　　　ServerName virtual.paching.com.tw:80<br>
                　　　&lt;Directory &quot;/srv/www/virtualdir&quot;&gt;<br>
                　　　　　　Order allow,deny<br>
                　　　　　　Allow from all<br>
                　　　&lt;/Directory&gt;<strong><br>
                　　　</strong><font color="#00FFFF">#<strong> </strong><font color="#FFFFFF"><font color="#00FFFF"><font size="2">在 
                Apache 的設定檔中，</font></font></font><font size="2">由於 /srv/www/virtualdir 
                這個目錄，從未設定過</font><strong><br>
                　　　</strong># <font color="#FFFFFF"><font color="#00FFFF"><font color="#FFFFFF"><font color="#00FFFF"><font size="2">有關</font></font></font><font size="2">存取權限</font></font></font><font size="2">方面的控管，因此這個地方務必要做設定。</font></font><strong><br>
                </strong>&lt;/VirtualHost&gt;<strong><br>
                <br>
                </strong>&lt;VirtualHost 192.168.1.111:80&gt;<br>
                　　　ServerName barry.paching.com.tw<br>
                　　　DocumentRoot &quot;/home/barry/public_html&quot;<strong><br>
                　　　</strong><font color="#00FFFF"># </font><font color="#00FFFF" size="2">這就是有關使用者 
                barry 個人網站的設定。</font><strong><br>
                </strong>&lt;/virtualhost&gt;<strong><br>
                </strong></p>
              </font></td>
          </tr>
        </table></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">重新啟動 Apache</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center" valign="middle">&nbsp;</td>
      <td><table width="100%" border="0" bordercolor="#CCCCCC" bgcolor="#000000">
          <tr> 
            <td><font color="#FFFFFF">Apache:~ # <strong><font color="#FFFF00">rcapache2 
              restart</font></strong></font></td>
          </tr>
        </table></td>
    </tr>
  </table>
  <p><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font> 
    <font size="4">Client 端測試</font> </strong></p>
  <table width="100%" border="0">
    <tr> 
      <td width="2%">&nbsp;</td>
      <td width="2%"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td width="96%"><strong><font color="#000099">先設定名稱伺服器</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td><div align="center"><img src="apache7.png" tppabs="http://www.suse.url.tw/picture/apache7.png" width="404" height="416"></div></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><font color="#000099"><strong>開始進行測試</strong></font></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td><p>URL : http://www.paching.com.tw/</p>
        <p align="center"> <img src="apache8.png" tppabs="http://www.suse.url.tw/picture/apache8.png" width="595" height="321"></p>
        <p> URL : http://virtual.paching.com.tw/</p>
        <p align="center"> <img src="apache9.png" tppabs="http://www.suse.url.tw/picture/apache9.png" width="589" height="385"> 
        </p>
        <p align="left">URL : http://barry.paching.com.tw/ </p>
        <p align="center"><img src="apache11.png" tppabs="http://www.suse.url.tw/picture/apache11.png" width="588" height="346"></p>
        <p align="center"><img src="apache12.png" tppabs="http://www.suse.url.tw/picture/apache12.png" width="593" height="350"></p></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
  </table>
  <p><strong> <font color="#000000">　</font></strong><font color="#000000">學會了虛擬主機的架設之後，是不是覺得蠻實用的呢，您有實做出來嗎 
    ? 沒有的話，可要加把勁了。<br>
    </font> <font color="#000000"><br>
    </font></p>
  </div>
<p align="center"><font color="#000000"><em>copyright &copy; 2006 by barry ( 柏青哥 
  )</em></font> <br>
</p>
</body>
</html>
