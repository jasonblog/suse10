<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>柏青哥的 SuSE Linux -- 架設 SSH  Server</title>
<style type="text/css">
<!--
a {
	color: #000099;
	text-decoration: none;
}
-->
</style>
</head>

<body bgcolor="#FFFFFF" background="sumtextb.jpg" tppabs="http://www.suse.url.tw/sumtextb.jpg" link="#000099" vlink="#000099" alink="#000099" leftmargin="40">
<a href="index-1.htm" tppabs="http://www.suse.url.tw/sles10/index.htm" target="_blank"><img src="first.GIF" tppabs="http://www.suse.url.tw/first.GIF" width="40" height="40" border="0" align="middle"></a> 
　　作者：陳柏菁<font size="+1">　</font>E-mail：pachingko@ms96.url.com.tw 
<table width="100%" border="0">
  <tr> 
    <td nowrap> <strong><font size="+1"></font></strong> <div align="center"> 
        <div align="center"><font size="+1"><font size="7"><strong>第十九章　遠端連線伺服器</strong></font></font></div>
        <font color="#0000FF" size="+1"><strong></strong></font></div>
      <div align="center"></div></td>
  </tr>
</table>
<br>
<font color="#000099" size="+1"><strong>索引：</strong></font><br>
<table width="100%" border="0">
  <tr> 
    <td colspan="3"><font color="#000099"><strong>19.1 <a href="#1">架設 SSH Server</a></strong></font></td>
  </tr>
  <tr> 
    <td width="4%"><font color="#000099">&nbsp;</font></td>
    <td width="6%" align="center" valign="top" nowrap><font color="#000099">19.1.1</font></td>
    <td width="90%"><a href="#2">SSH 協定及加密技術</a></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.1.2</font></td>
    <td><a href="#3">查詢套件安裝及檢視套件內容</a></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.1.3</font></td>
    <td><a href="#4">設定 OpenSSH Server</a></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.1.4</font></td>
    <td><font color="#000099"><a href="#5">SSH Client 端常使用的連線工具</a> ---<br>
      <a href="#6">ssh 及 putty</a> 、<a href="#7">scp</a>、<a href="#8">sftp</a></font></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.1.5</font></td>
    <td><a href="#9">使用 key 來做認證</a></td>
  </tr>
  <tr> 
    <td colspan="3"><font color="#000099"><strong>19.2 <a href="#10">VNC 遠端桌面遙控</a></strong></font></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.2.1</font></td>
    <td><a href="#11">VNC 概述</a></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.2.2</font></td>
    <td><a href="#12">安裝所需軟體</a></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.2.3</font></td>
    <td><font color="#000099"><a href="#13">Windows 遠端遙控 Linux</a> ---<br>
      <a href="#14">設定 Linux 擔任 VNC Server</a> <br>
      <a href="#15">Windows 遠端操控 Linux</a> </font></td>
  </tr>
  <tr> 
    <td><font color="#000099">&nbsp;</font></td>
    <td align="center" valign="top" nowrap><font color="#000099">19.2.4</font></td>
    <td><a href="#17">Linux 遠端遙控 Windows</a></td>
  </tr>
</table>
<br>
<hr>
<font color="#660066"><br>
</font> <strong><font color="#0000FF" size="+2"><a name="1"></a><font size="6">19.1 
架設 SSH Server </font></font></strong> 
<p><strong><font color="#000000" size="+1"><a name="2"></a><font size="5">19.1.1 
  SSH 協定及加密技術 </font></font></strong><br>
  <br>
  　還記得在第十一章介紹過的<a href="lesson11.htm#23" tppabs="http://www.suse.url.tw/sles10/lesson11.htm#23" target="_blank">遠端連線指令</a> telnet 及 ssh 
  吧 ! 由於 telnet 在資料傳輸過程的不安全，因此都鼓勵大家使用 ssh。那要提供 SSH 服務來給 Client 端做遠端連線時，當然就要架設 
  SSH Server 了。<br>
  <br>
  　SSH 可以取代傳統的 r 指令 (rsh、rlogin、rcp)、finger 及 telnet 這一類較不安全的連線工具。使用 SSH (Secure 
  SHell)，可讓我們所傳輸的資料都事先經過加密，因此 Client 端可以使用 scp 指令在兩台電腦間很安全的複製資料，也可以使用 sftp 指令來安心的存取 
  ftp 服務。 <br>
  <br>
  <strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"> 
  SSH 協定的版本<br>
  <br>
  </font></strong>　SSH 協定目前有 SSH1 ( SSH protocol version 1 ) 及 SSH2 ( SSH protocol 
  version 1 ) 兩種版本，當然現在的主流是 SSH2，因為它提供了比 SSH1 更安全的資料傳輸。<br>
  <br>
  　在 SSH 上頭，常見到的加密演算法有 RSA、DSA 及 Diffie-Hellman 等。SSH1 主要是使用 RSA 的加密技術，而 SSH2 
  除了 RSA 以外，還有 DSA 及 Diffie-Hellman 等等。 </p>
<p><font size="+1"><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font> 
  SSH 加密流程</strong></font></p>
<table width="100%" border="0">
  <tr> 
    <td width="2%">&nbsp;</td>
    <td width="3%" align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
    <td width="95%"><strong><font color="#000099">SSH1 加密技術</font></strong></td>
  </tr>
  <tr> 
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td><table width="100%" border="0">
        <tr> 
          <td width="4%" align="center" valign="top"><font size="4">˙</font></td>
          <td width="96%"><font color="#000000">Client 向 SSH Server 的 22 port 
            做出連線請求。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Server 傳送 public key 給 Client：<br>
            關於這個地方，您需先了解什麼是 host key pair 及 server key pair。<br>
            <font color="#0000FF">host key pair</font> 是指存在於 SSH Server 上的一對公鑰 
            (host public key) 及私鑰 (host private key)。<br>
            <font color="#0000FF">server key pair </font>是指在每次 SSH 服務啟動時，所隨機產生的一對公鑰 
            (server public key) 及私鑰 (server private key)，且這個 server key 預設每小時會更換一次。<br>
            而 SSH Server 所回應給 Client 的 public key，就是指 host public key 及 server 
            public key。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Client 端比對 host public key：<br>
            Client 端對 SSH Server 所傳送過來的 host public key 進行比對，如果與 ~/.ssh/known_hosts 
            檔案內容相符，則繼續進行下一步，否則會詢問您是否要接受這個 key，此時輸入 yes 就對了。<br>
            當使用者第一次與 Server 做連線時，由於之前並沒有取得這個 key，因此會詢問您是否要接受 Server 所傳來的 host 
            public key，那萬一先前已做過連線，現在還是看到這個訊息，這就表示 Server 上的 host public key 與 
            Client 的 known_hosts 比對不符合的結果，比如像 Server 的 SSH 套件重新安裝過後就會有這種情形發生。那萬一您遇到的狀況是在 
            key 比對不符後，直接拒絕您連線，這該怎麼辦呢 ? 很簡單，只要把 Client 的 ~/.ssh/ 目錄下的 known_hosts 
            檔刪除後，再與 Server 做連線，以重新取得 host public key 就行了。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Client 隨機產生一個 256 bit 的亂數 (session key)：<br>
            當第三步驟通過後，Client 隨即產生這個亂數，並使用剛剛從 Server 那裡所得到的那兩把 key 來一起做加密，完成後就傳回給 
            Server。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Server 使用 private key 來解密。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">爾後就透過這 session key 來作對稱式的加密使用。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Client 端開始進行認證，通過後，SSH 連線正式建立起來。</font></td>
        </tr>
      </table></td>
  </tr>
  <tr> 
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr> 
    <td>&nbsp;</td>
    <td align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
    <td><strong><font color="#000099">SSH2 加密技術</font></strong></td>
  </tr>
  <tr> 
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td><table width="100%" border="0">
        <tr> 
          <td width="4%" align="center" valign="top"><font size="4">˙</font></td>
          <td width="96%"><font color="#000000">Client 向 SSH Server 的 22 port 
            做出連線請求。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Server 傳送 host public key 給 Client：<br>
            在 SSH2 裡，sshd daemon 啟動時，並不會產生&nbsp;server key，所以只會傳送 host public 
            key 給 Client。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Client 端比對 host public key：<br>
            與 SSH1 的做法相同，不再贅述。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">使用 Diffie-Hellman 的演算法來產生&nbsp;session key，以作為連線加密使用。</font></td>
        </tr>
        <tr> 
          <td align="center" valign="top"><font size="4">˙</font></td>
          <td><font color="#000000">Client 端開始進行認證，通過後，SSH 連線正式建立起來。</font></td>
        </tr>
      </table></td>
  </tr>
</table>
<p><strong><font size="+1"><font color="#000000"><a name="3"></a><font size="5">19.1.2 
  需安裝套件及檢視套件內容</font><br>
  <br>
  </font></font><font size="+1"><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font></strong></font> 
  <font color="#000000" size="4">SSH 所需套件</font></strong></p>
<table width="35%" border="1">
  <tr bgcolor="#CCCCCC"> 
    <td width="29%" nowrap> <div align="center"><font color="#000099"><strong>套 
        件 名 稱</strong></font></div></td>
    <td width="71%" nowrap> <div align="center"><font color="#000099"><strong>簡　單　描　述</strong></font></div></td>
  </tr>
  <tr> 
    <td nowrap> <div align="center"><font color="#000099">openssh</font></div></td>
    <td nowrap><font color="#FFFFFF"><font color="#000099">SSH Server 的主要套件。</font></font></td>
  </tr>
</table>
<p><strong><font color="#000000"> 　</font></strong><font color="#000000">SuSE 
  預設就已經把此套件以及其相依套件都幫您裝上了，所以這部分不用各位操心。 <strong><br>
  <br>
  <font size="+1"><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font></strong></font> 
  <font size="4">查詢套件內容</font></strong></font></p>
<table width="100%" border="0">
  <tr> 
    <td bgcolor="#000000"><font color="#FFFFFF"> suse:~ # <font color="#FFFF00"><strong>rpm 
      -ql openssh</strong></font><br>
      <br>
      </font> <table width="100%" border="0">
        <tr> 
          <td width="19%"><font color="#FFFFFF">/etc/init.d/sshd</font></td>
          <td width="81%"><font color="#00FFFF" size="2">管理 SSH 服務的 script。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/etc/pam.d/sshd</font></td>
          <td><font color="#00FFFF" size="2"> sshd 所使用的 pam 模組設定檔。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/etc/ssh/sshd_config</font></td>
          <td><font color="#00FFFF" size="2">SSH Server 的主要設定檔。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/bin/scp</font></td>
          <td><font color="#00FFFF" size="2">這是使用 SSH 協定於兩台電腦間很安全的進行複製工作的指令。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/bin/sftp</font></td>
          <td><font color="#00FFFF" size="2">當要下載或上傳檔案時，可使用這個工具來保障資料傳輸的安全性。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/bin/ssh</font></td>
          <td><font color="#00FFFF" size="2">SSH Client 的遠端連線工具。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/bin/ssh-agent</font></td>
          <td><font color="#00FFFF" size="2">啟用代理認證的工具。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/bin/ssh-add</font></td>
          <td><p><font color="#00FFFF" size="2">當您啟用認證代理時，可利用此指令來幫您將 private key 
              登錄至代理認證之中。</font></p></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/bin/ssh-keygen</font></td>
          <td><font color="#00FFFF" size="2">欲採取 key 認證時，需使用這支程式來產生一對 key pair。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/sbin/rcsshd</font></td>
          <td><font color="#00FFFF" size="2">連結至 /etc/init.d/sshd 的符號連結檔。</font></td>
        </tr>
        <tr> 
          <td><font color="#FFFFFF">/usr/sbin/sshd</font></td>
          <td><font color="#00FFFF" size="2">提供 SSH 服務的 daemon。</font></td>
        </tr>
      </table></td>
  </tr>
</table>
<strong><font color="#000000" size="+1"><br>
<a name="4"></a><font size="5">19.1.3 設定 OpenSSH Server</font></font></strong><br>
<br>
　在介紹設定檔之前，先認識一下 /etc/ssh 目錄中的幾個檔案：<br>
<br>
<table width="100%" border="0">
  <tr> 
    <td height="72" bgcolor="#000000"><font color="#FFFFFF">suse:/etc/ssh # <strong><font color="#FFFF00">ls</font></strong><br>
      <font face="細明體">ssh_host_dsa_key　　　　ssh_host_key.pub　　　　sshd_config<br>
      ssh_host_dsa_key.pub　　ssh_host_rsa_key<br>
      ssh_host_key　　　　　　ssh_host_rsa_key.pub</font></font></td>
  </tr>
</table>
<p> 　針對以上幾個檔案做個簡短說明：</p>
<p><font color="#000099"><strong>　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> 
  sshd_config</strong></font>：SSH Server 的主要設定檔。</p>
<p><font color="#000099"><strong>　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> 
  ssh_host_key、ssh_host_key.pub：</strong><font color="#000000"> ssh1 的 RSA private 
  key 及 RSA public key。</font></font></p>
<p><font color="#000099"><strong>　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> 
  ssh_host_rsa_key、ssh_host_rsa_key.pub：</strong><font color="#000000">ssh2 的 
  RSA private key 及 RSA public key。</font></font></p>
<p><font color="#000099"><strong>　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> 
  ssh_host_dsa_key、ssh_host_dsa_key.pub：</strong><font color="#000000">ssh2 的 
  DSA private key 及 DSA public key。</font><strong><br>
  </strong></font><br>
  <strong><font color="#000000"><strong><font size="+1"><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font></strong></font></strong> 
  <font size="4"><strong>設定 sshd_config</strong></font><br>
  <br>
  　接著就對 SSH Server 的設定檔做個大略的解說：</p>
<table width="100%" border="0">
  <tr> 
    <td bgcolor="#000000"><font color="#FFFFFF">suse:/etc/ssh # <font color="#FFFF00"><strong>vi 
      sshd_config<br>
      </strong></font> <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">以下被註解起來的參數為系統的預設值。若要修改時，將註解拿掉並指定新的參數值即可。</font><br>
      <br>
      <strong># Port 22</strong><br>
      <font color="#00FFFF"># </font><font color="#00FFFF" size="2">SSH 預設所使用的 
      port。</font><br>
      <strong><br>
      # Protocol 2,1</strong><br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">表示支援 SSH1 
      及 SSH2。</font><br>
      <strong><br>
      # ListenAddress 0.0.0.0</strong><br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">sshd 所監聽的介面位址。預設是監聽所有的介面位址。 
      <br>
      </font><br>
      <font color="#00FFFF"># </font><font color="#00FFFF" size="2">以下的 HostKey 
      參數，是指定 host private key</font> <font color="#00FFFF" size="2">所存放的檔案 。</font><br>
      # HostKey for protocol version 1<strong><br>
      </strong># HostKey /etc/ssh/ssh_host_key<br>
      <strong> </strong># HostKeys for protocol version 2<strong><br>
      </strong># HostKey /etc/ssh/ssh_host_rsa_key<br>
      # HostKey /etc/ssh/ssh_host_dsa_key<br>
      <br>
      # Lifetime and size of ephemeral version 1 server key<strong><br>
      # KeyRegenerationInterval 1h<br>
      </strong><font color="#00FFFF">#</font><strong> </strong><font color="#00FFFF" size="2">SSH1 
      預設每小時會重新產生一次 server key。</font><strong><br>
      <br>
      # ServerKeyBits 768</strong><br>
      <font color="#00FFFF">#</font> <font color="#FFFFFF"><font color="#00FFFF" size="2">SSH</font></font><font color="#00FFFF" size="2">1 
      預設所使用 server key 的長度為 768 bits。</font><br>
      <br>
      <strong># SyslogFacility AUTH</strong><br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">指定 SSH 的訊息紀錄是使用預設的 
      AUTH 這個 facility。至於其他可用者如 <br>
      </font><font color="#FFFFFF"><font color="#00FFFF">#</font> </font><font color="#00FFFF" size="2">DAEMON, 
      USER, LOCAL0 ~ LOCAL7<font color="#FFFFFF"> <font color="#00FFFF">等。</font></font></font><br>
      <br>
      <strong># LoginGraceTime 2m</strong><br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">當使用者連上 SSH 
      Server 後，若兩分鐘內無法認證成功，則會被斷線。<br>
      </font><font color="#00FFFF"># </font><font color="#00FFFF" size="2">如設定成 
      0， 表無時間限制，另外時間單位未指定時，預設為秒。</font><br>
      <br>
      <strong># PermitRootLogin yes</strong><br>
      <font color="#00FFFF"># </font><font color="#00FFFF" size="2">SSH Server 
      預設是允許 root 登入的。您可以考慮把它改成 no。</font><br>
      <strong><br>
      # RSAAuthentication yes</strong><br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">是否允許使用 SSH1 
      的 RSA 認證。</font><br>
      <br>
      <strong># PubkeyAuthentication yes</strong><br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">是否允許使用 SSH2 
      的 public key 作認證。 <br>
      </font><br>
      <strong># AuthorizedKeysFile .ssh/authorized_keys</strong><br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">當採用 key 認證時，於 
      Client 端所產生的 public key，要存放在 Server 上的哪個檔案內。</font><strong><br>
      </strong><br>
      <strong> PasswordAuthentication no</strong><br>
      <font color="#00FFFF"># </font><font color="#00FFFF" size="2">是否要採用密碼認證。預設為 
      yes。 </font><br>
      <br>
      <strong>UsePAM yes</strong><br>
      <font color="#00FFFF"># <font size="2">是否使用 PAM 認證模組來進行認證工作。預設為 no。</font></font><br>
      <strong><br>
      DenyUsers user1 user2</strong> <br>
      <font color="#00FFFF">#</font> <font color="#00FFFF" size="2">設定拒絕登入的使用者名單。 
      </font></font></td>
  </tr>
</table>
<br>
　SuSE 預設開機時會啟動 SSH 服務，所以設定檔如有做任何的修改，請重新啟動 sshd：<br>
<br>
<table width="100%" border="0" bgcolor="#000000">
  <tr>
    <td height="25"><font color="#FFFFFF">suse:~ #<strong> <font color="#FFFF00">rcsshd 
      restart</font></strong></font></td>
  </tr>
</table>
<br>
<br>
<font size="+1"><strong><font color="#000000"><a name="5"></a><font size="5">19.1.4 
SSH Client 端常使用的連線工具</font></font></strong></font><br>
<br>
<strong><font size="+1"><a name="6"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font></strong> 
<font color="#000000" size="+1"><strong>指令 ssh</strong></font><strong><font size="+1"> 
及 putty</font></strong> <font size="4"><strong>軟體</strong></font><br>
<br>
　這個 ssh 指令是 Linux Client 常使用的遠端連線程式，至於 putty 或 pietty 則是 windows 中較出名的連線工具。<br>
<br>
<table width="100%" border="0">
  <tr>
    <td width="2%">&nbsp;</td>
    <td width="3%" align="center" valign="middle"><font color="#000099"><strong><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></strong></font></td>
    <td width="95%"><strong><font color="#000099">ssh for Linux：</font></strong></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center" valign="middle">&nbsp;</td>
    <td><table width="98%" border="0">
        <tr> 
          <td bgcolor="#000000"><font color="#FFFFFF">Client:~ # <font color="#FFFF00"><strong>ssh 
            192.168.1.111</strong></font><br>
            Client:~ #<font color="#FFFF00"><strong> ssh -l barry 192.168.1.111</strong></font><br>
            Client:~ #<font color="#FFFF00"><strong> ssh barry@192.168.1.111</strong></font></font></td>
        </tr>
      </table>
      <br>
      以上的範例應該沒問題才是。如有所遺忘，請回到 [<a href="lesson11.htm#23" tppabs="http://www.suse.url.tw/sles10/lesson11.htm#23" target="_blank">11.3.3 
      遠端連線指令</a>] 去做個複習。 </td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center" valign="middle">&nbsp;</td>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center" valign="middle"><font color="#000099"><strong><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></strong></font></td>
    <td><strong><font color="#000099">putty for Windows：</font></strong></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center" valign="middle">&nbsp;</td>
    <td><p>想在 Windows 中對 Linux 的 SSH Server 做遠端連線，可至官方網站去下載 putty 軟體：<br>
        <a href="javascript:if(confirm(%27http://www.chiark.greenend.org.uk/%7Esgtatham/putty/download.html  \n\nThis file was not retrieved by Teleport Pro, because it is addressed on a domain or path outside the boundaries set for its Starting Address.  \n\nDo you want to open it from the server?%27))window.location=%27http://www.chiark.greenend.org.uk/%7Esgtatham/putty/download.html%27" tppabs="http://www.chiark.greenend.org.uk/%7Esgtatham/putty/download.html" target="_blank">http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html</a> 
        <br>
        在這個網頁裡，還可看到像 pscp、psftp 等這一類的工具，視您需要而做選擇囉。<br>
        <br>
        當您將 putty 下載回來後，請直接執行 putty 程式，然後就會看到設定畫面：</p>
      <p align="center"> <img src="ssh1.png" tppabs="http://www.suse.url.tw/picture/ssh1.png" width="426" height="435"> 
        <br>
        <font size="2">圖一：putty 設定主畫面</font></p>
      <p> 接著請輸入伺服器的位址及所使用協定，並於 [Saved Sessions] 處填寫個具代表性的名稱，最後按下 [Save] 來將設定紀錄保留下來：</p>
      <p align="center"> <img src="ssh2.png" tppabs="http://www.suse.url.tw/picture/ssh2.png" width="426" height="435"> 
        <br>
        <font size="2">圖二：設定 SSH Server 位址及使用協定</font></p>
      <p> 以下是選擇性的調整。首先調整 putty 視窗大小：</p>
      <p align="center"> <img src="ssh3.png" tppabs="http://www.suse.url.tw/picture/ssh3.png" width="426" height="435"> 
        <br>
        <font size="2">圖三：調整 putty 視窗大小</font></p>
      <p>再來調整一下字型的部分，請先點選 [Appearance]，然後按下右邊的 [Change]：</p>
      <p align="center"><img src="ssh4.png" tppabs="http://www.suse.url.tw/picture/ssh4.png" width="426" height="435"> 
        <br>
        <font size="2">圖四：修改喜好設定 </font></p>
      <p>這裡就視您需要做調整囉： </p>
      <p align="center"><img src="ssh5.png" tppabs="http://www.suse.url.tw/picture/ssh5.png" width="437" height="319"> 
        <br>
        <font size="2">圖五：調整使用字型及大小</font></p>
      <p>修改完成後，請點選 [Session] 來回到主畫面，再按一次 [Save] 把剛剛所做的修改保留下來：</p>
      <p align="center"><img src="ssh6.png" tppabs="http://www.suse.url.tw/picture/ssh6.png" width="426" height="435"> 
        <br>
        <font size="2">圖六：完成後之畫面</font></p>
      <p>就這麼簡單而已，自己試試看噢。 </p>
              </td>
  </tr>
</table>
<br>
<strong><font size="+1"><a name="7"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font></strong><font size="+1"><strong> 
指令 scp</strong></font> <br>
<br>
　想要在兩主機之間很安全的執行複製的動作，就使用這個指令吧 !<strong><br>
<br>
範例說明</strong>：<br>
<table width="100%" border="0">
  <tr> 
    <td bgcolor="#000000"><font color="#FFFFFF"><font color="#00FFFF" size="2">範例一：將遠端 
      SSH Server 上的 /etc/passwd 複製到本機 /tmp 目錄下</font><font size="2"><font color="#00FFFF">。</font></font><br>
      client:~ #<font color="#FFFF00"> <strong>scp 192.168.1.111:/etc/passwd /tmp</strong></font><br>
      Password:　<font color="#CCCCCC" size="2">←</font> <font color="#CCCCCC" size="2">輸入遠端主機上 
      root 的密碼。</font><font size="2"><strong><br>
      </strong></font><font size="2"><strong><br>
      </strong></font></font> <font color="#FFFFFF"><font color="#00FFFF" size="2">範例二：</font></font><font color="#00FFFF" size="2">將本機的 
      /var/log 目錄複製到遠端主機的 /tmp/logdir 中</font><font color="#FFFFFF"><font size="2"><font color="#00FFFF">。</font></font><br>
      client:~ # <strong><font color="#FFFF00">scp -r /var/log 192.168.1.111:/tmp/logdir</font></strong><br>
      Password:　<font color="#CCCCCC" size="2">←</font> <font color="#CCCCCC" size="2">輸入遠端主機上 
      root 的密碼。</font><br>
      <font color="#00FFFF">#</font><font size="2"><strong> </strong></font></font><font color="#00FFFF" size="2">這個範例中，如 
      logdir 已存在於遠端主機上，那麼會把 log 目錄整個複製到 logdir <br>
      </font><font color="#FFFFFF"><font color="#00FFFF">#</font><font size="2"><strong> 
      </strong></font><font color="#FFFFFF"><font color="#00FFFF" size="2">目錄下，</font></font><font color="#00FFFF" size="2">如 
      logdir 不存在，則會將 log 目錄的內容複</font></font><font color="#00FFFF" size="2">製到 
      logdir 中。</font><font color="#FFFFFF"><br>
      </font> <font color="#FFFFFF"><br>
      <font color="#00FFFF" size="2">範例三：</font><font color="#FFFFFF"><font size="2"><font color="#00FFFF">將遠端主機 
      tina 家目錄下的 file，複製到本地端的 /tmp 目錄中</font></font></font><font size="2"><font color="#00FFFF">。</font></font><br>
      mary@client:~&gt; <strong><font color="#FFFF00">scp tina@192.168.1.111:~/file 
      /tmp</font></strong><br>
      Password:　<font color="#CCCCCC" size="2">←</font> <font color="#CCCCCC" size="2">輸入遠端主機上 
      tina 的密碼。</font><br>
      </font> <font color="#FFFFFF"><font color="#00FFFF">#</font><font size="2"><strong> 
      </strong><font color="#00FFFF">檔案複製回來後，觀察一下 /tmp/file 的擁有者可是 mary 噢。</font></font><br>
      <br>
      <font color="#00FFFF" size="2">範例四：</font><font size="2"><font color="#00FFFF">將本機 
      /tmp/file 複製至遠端主機的 /tmp 目錄中。</font></font><br>
      mary@client:~&gt;<strong> <font color="#FFFF00">scp /tmp/file tina@192.168.1.111:/tmp</font></strong><br>
      Password:　<font color="#CCCCCC" size="2">←</font> <font color="#CCCCCC" size="2">輸入遠端主機上 
      tina 的密碼。</font> <br>
      <font color="#00FFFF">#</font><font size="2"><strong> </strong><font color="#FFFFFF"><font color="#00FFFF">此時遠端主機的 
      /tmp/file，其擁有者為 tina。</font></font></font></font></td>
  </tr>
</table>
<br>
<strong><font size="+1"><a name="8"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font></strong> 
<strong><font size="+1">指令 sftp</font></strong> <br>
<br>
　這是另一個可以使用的檔案傳輸工具，與 ftp 操作介面類似，不過其所傳輸的資料是會事先經過加密的噢。<br>
<br>
<strong>範例說明</strong>：<br>
<table width="100%" border="0">
  <tr> 
    <td bgcolor="#000000"><font color="#FFFFFF">mary@client:~&gt;<font color="#FFFF00"> 
      <strong>sftp tina@192.168.1.111</strong></font><br>
      Connecting to 192.168.1.111...<br>
      Password:　<font color="#CCCCCC" size="2">← 輸入遠端主機上 tina 的密碼。</font><br>
      sftp&gt;<br>
      <font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">這裡的操作與傳統的 
      ftp 差不多。不清楚的話，可輸入 &quot;<strong>?</strong>&quot; 來了解有哪些指令可以利用，<br>
      </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">很容易的，自己練習看看。</font></td>
  </tr>
</table>
<br>
<br>
<font size="+1"><strong><font color="#000000"><a name="9"></a><font size="5">19.1.5 
使用 key 來做認證</font></font></strong></font><br>
<br>
　前面我們所介紹的 SSH 連線過程，都是使用密碼來做認證，而這一小節要介紹另一個更安全的做法，就是使用 public key 認證。先說明等一下 key 
認證的執行步驟：<br>
<br>
<table width="100%" border="0">
  <tr> 
    <td width="2%" align="center" valign="top" nowrap>&nbsp;</td>
    <td width="3%" align="center" valign="top" nowrap><font color="#000099">1.</font></td>
    <td width="95%"><font color="#000099">Client 端的使用者 mary，想以 Server 上 barry 
      的身分做遠端連線。首先 Client 端的 mary，先執行 ssh-keygen 指令，以產生一對 RSA 或 DSA key pair (公鑰及私鑰)。</font></td>
  </tr>
  <tr> 
    <td align="center" valign="top" nowrap>&nbsp;</td>
    <td align="center" valign="top" nowrap><font color="#000099">2.</font></td>
    <td><font color="#000099">Client 端確認在 /home/mary/.ssh/ 目錄下，有產生一對 public key 
      及 private key，順便檢視 .ssh 目錄及此目錄下的 private key，其權限是否分別為 700 及 600。</font></td>
  </tr>
  <tr> 
    <td align="center" valign="top" nowrap>&nbsp;</td>
    <td align="center" valign="top" nowrap><font color="#000099">3.</font></td>
    <td><font color="#000099">再來將剛剛所產生的 public key，存放至 Server 端 /home/barry/.ssh/authorized_keys 
      中。</font></td>
  </tr>
</table>
<br>
　步驟就那麼簡單，馬上實做一次吧：<br>
<br>
<table width="100%" border="0">
  <tr> 
    <td nowrap bgcolor="#000000"><p><font color="#00FF00" size="2">1. Client 端先產生一對 key 
        pair：</font><font color="#FFFFFF"><br>
        mary@Client:~&gt;<strong><font color="#FFFF00"> ssh-keygen -t dsa</font></strong>　<font color="#00FFFF" size="2"><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font></font><font color="#00FFFF" size="2">使用 
        ssh-keygen 指令，來產生一對 DSA key pair。<br>
        </font><font color="#00FFFF"># </font><font color="#00FFFF" size="2">如果想產生 
        RSA key pair，請執行 &quot;ssh-keygen -t rsa&quot;。</font><br>
        Generating public/private dsa key pair.<br>
        Enter file in which to save the key (/home/mary/.ssh/id_dsa):　<br>
        <font color="#00FFFF"># </font> <font size="2"><font color="#00FFFF">上面括弧內所顯示的是 
        key 預設所存放的位置。請按下 Enter 鍵</font></font></font><font color="#00FFFF" size="2">來繼續。</font><font color="#FFFFFF"><br>
        Enter passphrase (empty for no passphrase):　　　　　　 <br>
        Enter same passphrase again:<br>
        <font color="#00FFFF"># </font> <font size="2"><font color="#00FFFF">這是通關密語的設定，筆者這裡就輸入 
        123456。</font><br>
        </font><font color="#FFFFFF"><font color="#00FFFF"># </font> </font><font color="#00FFFF" size="2">等稍後整個 
        key 認證設定完成後，在做連線測試時，就會要求您輸入通關密語。</font><br>
        <font color="#00FFFF"># </font> <font color="#00FFFF" size="2">如果此處未做設定，那等會兒的連線過程就不會要求您做輸入了。</font><br>
        Your identification has been saved in /home/mary/.ssh/id_dsa. <br>
        Your public key has been saved in /home/mary/.ssh/id_dsa.pub. <br>
        The key fingerprint is:<br>
        c4:08:fd:70:8d:66:b0:dc:d4:ed:c1:0f:2f:09:3c:7f mary@Client<br>
        <br>
        <font color="#00FF00" size="2">2. 檢查一下權限：</font><br>
        mary@Client:~&gt;<strong><font color="#FFFF00"> ls -ld .ssh .ssh/id_dsa</font></strong><br>
        <font face="細明體">drwx------　2　mary　users　136　Nov 30 02:28　<font color="#0099FF">.ssh</font></font><br>
        <font face="細明體">-rw-------　1　mary　users　736　Nov 30 02:28　.ssh/id_dsa</font><br>
        <br>
        <font color="#00FF00" size="2">3. 將 public key 複製到 Server 上：</font><font color="#FF0000"><br>
        </font> mary@Client:~/.ssh&gt; <strong><font color="#FFFF00">scp id_dsa.pub 
        barry@192.168.1.111:~/.ssh/authorized_keys</font></strong><br>
        Password:<br>
        id_dsa.pub 　　　100% 　　　601　　　 0.6KB/s 　　　00:00 <br>
        <font color="#00FFFF"># </font> <font size="2"><font color="#00FFFF" size="2">如遠端主機的 
        barry 家目錄中，尚無 .ssh 目錄，請先建立起來後再執行這個步驟。</font></font> <br>
        </font></p>
      </td>
  </tr>
</table>
<font color="#000000"><br>
　接著進行測試：<br>
<br>
</font> 
<table width="100%" border="0">
  <tr> 
    <td nowrap bgcolor="#000000"><font color="#FFFFFF">mary@Client:~&gt;<strong><font color="#FFFF00"> 
      ssh barry@192.168.1.111</font></strong><br>
      Enter passphrase for key '/home/mary/.ssh/id_dsa':　<font color="#00FFFF" size="2">← 
      輸入當初設定的通關密語。</font><br>
      Last login: Mon Dec 5 16:25:25 2006 from 192.168.1.130<br>
      barry@<strong>suse</strong>:~&gt;</font></td>
  </tr>
</table>
<font color="#000000">　　<br>
</font> 　好了，目前已經成功的使用 public key 來做認證了。不過在這個範例中，因為當初有設定通關密語的關係，所以在連線過程會要求您做輸入。如果現在希望能略過這個步驟，也就是不想輸入通關密語而能直接連線，則需啟用代理認證，詳細做法如下：<br>
<br>
<table width="100%" border="0">
  <tr> 
    <td bgcolor="#000000"><font color="#FFFFFF">mary@Client:~&gt; <font color="#FFFF00"><strong>ssh-agent 
      bash</strong></font><br>
      <font color="#00FFFF"># </font> <font size="2"><font color="#00FFFF">啟用代理認證。<font color="#FFFFFF"><br>
      </font></font></font><br>
      mary@Client:~&gt; <font color="#FFFF00"><strong>ssh-add</strong></font><br>
      Enter passphrase for /home/mary/.ssh/id_dsa:　<font color="#00FFFF" size="2">← 
      請輸入通關密語。</font><br>
      Identity added: /home/mary/.ssh/id_dsa (/home/mary/.ssh/id_dsa)<br>
      <font color="#00FFFF"># </font> <font size="2"><font color="#00FFFF">將 private 
      key </font></font><font color="#00FFFF" size="2">加入代理認證之中。</font><br>
      <br>
      <font color="#FFFFFF"><font color="#00FFFF"># </font> </font><font color="#00FFFF" size="2">完成後做個連線測試：</font><br>
      mary@Client:~&gt; <font color="#FFFF00"><strong>ssh barry@192.168.1.111</strong></font><br>
      Last login: Mon Dec 5 18:00:13 2006 from 192.168.1.130<br>
      barry@suse:~&gt;<br>
      <font color="#FFFFFF"><font color="#00FFFF"># </font> </font><font color="#00FFFF" size="2">注意到沒，這次連線過程沒有要求您輸入通關密語。<br>
      </font><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
      </font> </font><font color="#00FFFF" size="2">啟用代理認證時，會進入到另一個shell (sub-shell) 
      之中，因此當您要結束<br>
      </font><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
      </font> </font><font color="#00FFFF" size="2">代理認證時，<font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF">即可</font></font></font></font>執行 
      exit 指令，來退回原來的 shell。</font></font></font></font></font></td>
  </tr>
</table>
<br>
　採用 key 認證的做法就大致如此。現在再出個狀況，如果在 Client 端又有另一個使用者 tina，也想透過 key 認證方式來以 server 上 
barry 的身分做遠端連線時該怎麼做呢 ? 請參考以下的做法：<br>
<br>
<table width="100%" border="0">
  <tr> 
    <td bgcolor="#000000"><p><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
        </font> </font><font color="#00FFFF" size="2">先產生 RSA key pair：</font></font></font></font><br>
        tina@Client:~&gt;<strong><font color="#FFFF00"> ssh-keygen -t rsa</font></strong>　<br>
        Generating public/private rsa key pair.<br>
        Enter file in which to save the key (/home/tina/.ssh/id_rsa):　<br>
        Created directory '/home/tina/.ssh'.<br>
        Enter passphrase (empty for no passphrase): <font color="#00FFFF" size="2">← 
        這次不輸入通關密語，直接按下 Enter 鍵。</font><br>
        Enter same passphrase again:　<font color="#00FFFF" size="2">← 按下 Enter 
        鍵。</font><br>
        Your identification has been saved in /home/tina/.ssh/id_rsa.<br>
        Your public key has been saved in /home/tina/.ssh/id_rsa.pub.<br>
        The key fingerprint is:</font><br>
        <font color="#FFFFFF">52:05:89:eb:b1:f6:95:c6:b5:bf:d4:f9:c1:73:a2:60 
        tina@Client<br>
        <br>
        <font color="#FFFFFF"><font color="#00FFFF"># </font> </font><font color="#00FFFF" size="2">把 
        rsa public key 複製到 server 上 barry 的家目錄裡：</font><br>
        tina@Client:~&gt; <font color="#FFFF00"><strong>scp .ssh/id_rsa.pub barry@192.168.1.111:~</strong></font><br>
        barry@192.168.1.111's password:<br>
        id_rsa.pub　　100%　　221　　0.2KB/s　　00:00 <br>
        <br>
        <font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># </font> 
        </font></font><font color="#00FFFF" size="2">最後請在 server 主機上，將 id_rsa.pub 
        內容附加至 authorized_keys 檔案中：</font><br>
        barry@suse:~&gt;<font color="#FFFF00"><strong> cat id_rsa.pub &gt;&gt; 
        .ssh/authorized_keys<br>
        </strong></font><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
        </font> </font></font><font color="#00FFFF" size="2">這個地方千萬不要把 authorized_keys 
        的原先內容覆蓋掉，<br>
        </font><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
        </font> </font></font></font></font><font color="#00FFFF" size="2">不然之前的使用者 
        mary 就無法做 key 認證了。 </font></font><font color="#00FFFF"></font><font color="#FFFF00"><strong><br>
        </strong></font></font></p>
      </td>
  </tr>
</table>
<br>
　Client 端測試：<br>
<br>
<table width="100%" border="0">
  <tr> 
    <td bgcolor="#000000"><font color="#FFFFFF">tina@Client:~&gt; <font color="#FFFF00"><strong>ssh 
      barry@192.168.1.111</strong></font><br>
      Last login: Tue Dec 6 15:23:49 2006 from 192.168.1.130<br>
      barry@suse:~&gt;<br>
      <font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
      </font> </font></font></font><font color="#00FFFF" size="2">注意到沒 ? 這次連線過程沒有要求您輸入通關密語噢，因為<br>
      </font><font color="#FFFFFF"><font color="#FFFFFF"><font color="#FFFFFF"><font color="#00FFFF"># 
      </font> </font></font></font><font color="#00FFFF" size="2"> 剛剛在建立 RSA key 
      pair 的過程，根本就沒有做設定啊。</font></font></td>
  </tr>
</table>
<br>
<font color="#0000FF" size="+2"><strong><br>
<a name="10"></a><font size="6">19.2 VNC 遠端桌面遙控</font></strong></font><br>
<br>
<font color="#000000" size="+1"><strong><a name="11"></a><font size="5">19.2.1 
VNC 概述</font></strong></font><br>
<br>
　VNC (Virtual Network Computing) 為一遠端桌面遙控軟體，是由 AT&amp;T 所開發的，並使用 GPL 授權模式來對外發行，亦即其是一開放原始碼的軟體，任何人皆可免費自由取得。<br>
<br>
　VNC 最大特色是支援許多不同的操作平台，您可以將其安裝在 Windows、MacOS、Unix、Unix-Like 等等的作業系統上，並可在這些不同的作業系統間來相互操作。<br>
<br>
　VNC 軟體可區分成兩個部分，即 VNC viewer ( 主控端 ) 跟 VNC server ( 被控端 )，您只要在 Sever 端安裝 VNC server 
軟體後，就可以於 Client 端使用 VNC viewer 軟體來對其進行遠端遙控。另外即使 Client 端沒有安裝 VNC viewer 軟體也沒關係，因為 
Client 端也可以直接透過瀏覽器來進行遠端桌面操控。<br>
<br>
<font size="+1"><strong><a name="12"></a><font size="5">19.2.2 安裝所需軟體</font></strong></font><br>
<br>
　由於 VNC 可以在相同或不同的作業系統間做遠端遙控，因此等會兒我們就嘗試看看如何在 windows 及 linux 間，相互使用 VNC 來做遠端操控囉。不過於實作之前，請您先把在 
linux 及 windows 上頭所需安裝的軟體先搞定再說。　　<br>
<br>
　SuSE Linux 裡已經同時包含了 VNC server 及 VNC viewer 軟體，因此您不須額外下載。至於所需套件為 xorg-x11-Xvnc 
及 tightvnc，趕快檢查看看吧 ! <br>
<br>
　至於 windows 的話，請先至 www.realvnc.com 下載 VNC 軟體，然後再進行安裝。詳細步驟請參考以下。<br>
<br>
<strong><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></strong> <font size="+1"><strong>下載 
VNC 軟體 ( for windows )</strong></font><br>
<br>
　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> <font color="#0000CC">連上 
VNC 網站，並點選 <strong>[download it now]</strong>： </font> 
<p align="center"> <img src="vnc1.png" tppabs="http://www.suse.url.tw/picture/vnc1.png" width="666" height="479"></p>
<p align="left">　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> <font color="#000099"></font><font color="#000099">點選 
  <strong>[Download &amp; use]</strong>：</font></p>
<p align="center"> <img src="vnc2.png" tppabs="http://www.suse.url.tw/picture/vnc2.png" width="666" height="479"></p>
<p align="left">　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> <font color="#000099">點選 
  <strong>[Procceed to download]</strong>：</font></p>
<p align="center"> <img src="vnc3.png" tppabs="http://www.suse.url.tw/picture/vnc3.png" width="666" height="479"></p>
<p align="left"> 　　 <img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"><font color="#000099"> 
  下載 for windows 的免費 VNC 軟體：</font> </p>
<p align="center"> <img src="vnc4.png" tppabs="http://www.suse.url.tw/picture/vnc4.png" width="666" height="479"></p>
　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> <font color="#000099">接受聲明並下載：</font> 
<p align="center"> <img src="vnc5.png" tppabs="http://www.suse.url.tw/picture/vnc5.png" width="666" height="479"></p>
<p align="left">　　<img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"> <font color="#000099">將下載檔案儲存起來： 
  </font></p>
<p align="center"><img src="vnc6.png" tppabs="http://www.suse.url.tw/picture/vnc6.png" width="398" height="269"></p>
<div align="left"> <strong><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"><font size="+1"> 
  安裝 VNC<br>
  <br>
  　</font></strong>啟動剛剛下載回來的執行程式來開始進行安裝，步驟如下： <font size="+1"><strong><br>
  </strong></font> 
  <p align="center"> <img src="vnc7.png" tppabs="http://www.suse.url.tw/picture/vnc7.png" width="503" height="385"><br>
    <font size="2">圖一：VNC 設定精靈畫面</font><br>
    <br>
    <img src="vnc8.png" tppabs="http://www.suse.url.tw/picture/vnc8.png" width="503" height="385"><br>
    <font size="2">圖二：接受授權同意聲明</font><br>
    <br>
    <img src="vnc9.png" tppabs="http://www.suse.url.tw/picture/vnc9.png" width="503" height="385"><br>
    <font size="2">圖三：VNC 預設的安裝位置畫面</font><font size="1"> </font> </p>
  <p align="center"> <img src="vnc10.png" tppabs="http://www.suse.url.tw/picture/vnc10.png" width="503" height="385"><br>
    <font size="2">圖四：選擇安裝項目</font><br>
    <br>
    <img src="vnc11.png" tppabs="http://www.suse.url.tw/picture/vnc11.png" width="503" height="385"> <br>
    <font size="2">圖五： 設定存放 VNC 程式捷徑之處</font><br>
    <br>
    <img src="vnc12.png" tppabs="http://www.suse.url.tw/picture/vnc12.png" width="503" height="385"> <br>
    <font size="2">圖六：執行額外工作的設定畫面 </font></p>
  <p align="center">　　<img src="vnc13.png" tppabs="http://www.suse.url.tw/picture/vnc13.png" width="503" height="385"><br>
    <font size="2">圖七：準備安裝畫面 </font><font size="1"> </font> </p>
  <p align="center"> <img src="vnc13.2.png" tppabs="http://www.suse.url.tw/picture/vnc13.2.png" width="353" height="428"> 
    <br>
    <font size="2">圖八：準備設定 VNC Server 的密碼</font><br>
    <br>
    <img src="vnc13.4.png" tppabs="http://www.suse.url.tw/picture/vnc13.4.png" width="325" height="139"><br>
    <font size="2">圖九：設定 VNC Server 密碼畫面</font> </p>
  <p align="left">　　在圖九中按下 [OK] 後，會回到圖八畫面，此時點選 [確定] 即可。</p>
  <p align="center"> <img src="vnc14.png" tppabs="http://www.suse.url.tw/picture/vnc14.png" width="503" height="385"><br>
    <font size="2">圖十：重要訊息畫面</font> <br>
    <br>
    <img src="vnc15.png" tppabs="http://www.suse.url.tw/picture/vnc15.png" width="503" height="385"><br>
    <font size="2">圖十一：VNC 設定精靈完成畫面</font> </p>
  <p align="left">　這樣就安裝完畢了，夠簡單吧。</p>
  <font size="+1"><strong> </strong></font><strong><font size="+1"> <a name="13"></a><font size="5">19.2.3 
  Windows 遠端遙控 Linux</font></font></strong><font color="#000000"><br>
  <br>
  　這一小節主要是要介紹如何以 Linux 擔任 VNC server，並讓 Windows 的 Client 端能對其進行遠端操控，因此重點就放在 Linux 
  的設定上頭囉。<br>
  <br>
  <strong><font size="+1"><a name="14"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"> 
  </font><font color="#000000"><font size="+1"><strong>設定 Linux 擔任 VNC server</strong></font></font><font size="+1"> 
  </font></strong><br>
  <br>
  </font> 
  <table width="100%" border="0">
    <tr> 
      <td width="2%">&nbsp;</td>
      <td width="3%" align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td width="95%"><strong><font color="#000099">初次啟動 VNC server</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td><table width="100%" border="0">
          <tr> 
            <td bgcolor="#000000"><font color="#FFFFFF">suse:~ #<font color="#FFFF00"><strong> 
              vncserver </strong></font> <br>
              <br>
              <font face="細明體">You will require a password to access your desktops.</font></font> 
              <br> <br> <font color="#FFFFFF" face="細明體">Password:　<font color="#00FFFF" size="2">← 
              首次啟動 VNC server 時，須設定提供給 Client 端做遠端操控時，</font><br>
              Verify:<strong><font size="2"> 　　　 </font></strong><font size="2"><font color="#00FFFF">所需</font></font><font color="#00FFFF" size="2">輸入的密碼。</font></font><font color="#FFFFFF"><br>
              <font face="細明體">　　 <br>
              Would you like to enter a view-only password (y/n)? <strong><font color="#FFFF00">n</font> 
              </strong><font size="2">←</font></font></font> <font color="#FFFFFF" size="2">請輸入 
              n<font face="細明體">。</font></font><font color="#FFFFFF" face="細明體"><strong><br>
              </strong></font><font color="#00FFFF"># </font><font color="#00FFFF" face="細明體"><font size="2">這是詢問您，要不要設定一個只允許給 
              Client 端瀏覽而不能操控的密碼。</font></font><font color="#FFFFFF"> <br>
              <br>
              <font face="細明體">New 'X' desktop is suselinux:1<br>
              <font color="#00FFFF">#<font color="#FFFFFF"><font face="細明體"><font color="#00FFFF"> 
              <font size="2">請留</font></font></font></font><font size="2">意結尾的數字 
              1，此乃 VNC 所提供的 X Server 視窗編號。</font></font></font> <br>
              <br>
              <font face="細明體">Creating default startup script /root/.vnc/xstartup<br>
              Starting applications specified in /root/.vnc/xstartup<br>
              Log file is /root/.vnc/suselinux:1.log</font></font></td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">修改 VNC 預設要執行的 Script</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td><table width="100%" border="0">
          <tr> 
            <td bgcolor="#000000"><font color="#FFFFFF">suse:~ #<font color="#FFFF00"><strong> 
              vi .vnc/xstartup</strong></font><br>
              <font color="#0066FF">#</font><font color="#0066FF" face="細明體">!/bin/sh</font><font face="細明體"> 
              </font></font> <br> <br> <font color="#FFFFFF" face="細明體">xrdb $HOME/.Xresources<br>
              xsetroot -solid grey<br>
              xterm -geometry 80x24+10+10 -ls -title &quot;$VNCDESKTOP Desktop&quot; 
              &amp;<br>
              <strong>gnome-session</strong> &amp;<br>
              </font><font color="#00FFFF">#<font size="2" face="細明體"> </font></font><font color="#FFFFFF"><font color="#00FFFF" size="2" face="細明體">當桌面環境是 
              gnome 時，就把 twm 改成 gnome-session 即可</font></font><font color="#00FFFF" size="2" face="細明體">。<br>
              </font><font color="#00FFFF">#<font size="2" face="細明體"> </font></font><font color="#00FFFF" size="2" face="細明體">如是 
              kde 的話，就修改成 startkde。</font></td>
          </tr>
        </table></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">重新啟動 VNC server</font></strong></td>
    </tr>
    <tr> 
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td><table width="100%" border="0">
          <tr> 
            <td bgcolor="#000000"><font color="#FFFFFF"><font color="#00FFFF">#</font> 
              <font color="#00FFFF" size="2">先停止 VNC server 服務：</font><br>
              suse:~ #<font color="#FFFF00"><strong> vncserver -kill :1</strong></font><br>
              Killing Xvnc process ID 4453<br>
              <br>
              <font color="#FFFFFF"><font color="#00FFFF">#</font> </font><font color="#00FFFF" size="2">再啟動 
              VNC Server：</font><br>
              suse:~ # <strong><font color="#FFFF00">vncserver </font></strong> 
              <br>
              <br>
              New 'X' desktop is suselinux:1 <br>
              <br>
              Starting applications specified in /root/.vnc/xstartup<br>
              Log file is /root/.vnc/suselinux:1.log<font color="#FFFFFF"><strong><font color="#00FFFF"><br>
              <br>
              </font></strong><font color="#00FFFF">#</font> </font><font color="#00FFFF" size="2">成功啟動後，可順便檢查一下 
              VNC 所提供服務的 port：</font> <br>
              suse:~ # <strong><font color="#FFFF00">netstat -anp | egrep '5801|5901'</font></strong><br>
              <font face="細明體">tcp 　0 　0 　0.0.0.0:5801 　0.0.0.0:* 　LISTEN 　5889/Xvnc<br>
              tcp 　0 　0 　0.0.0.0:5901 　0.0.0.0:* 　LISTEN 　5889/Xvnc </font></font></td>
          </tr>
        </table>
        <br>
        這樣就完成了被控端的設定了。而將來如果您想修改 VNC server 上的連線密碼，則請直接輸入 vncpasswd 指令去修改即可。 </td>
    </tr>
  </table>
  <font color="#000000"> <br>
  <strong><font size="+1"><a name="15"></a><img src="1775.gif" tppabs="http://www.suse.url.tw/picture/1775.gif" width="18" height="18"></font></strong> 
  <strong><font size="+1">Windows 遠端操控 Linux</font></strong> <br>
  <br>
  　這裡會分別以安裝在 Windows 上的 VNC viewer 軟體及網頁瀏覽器方式，來對 Linux 做遠端操控。 <br>
  <br>
  </font> 
  <table width="100%" border="0">
    <tr>
      <td width="2%">&nbsp;</td>
      <td width="3%" align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td width="95%"><strong><font color="#000099">使用 VNC viewer</font></strong> 
        <font color="#000099"><strong>程式</strong></font></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td><p align="left">如果您剛剛在 Windows 上頭安裝 VNC 軟體時，是按照筆者的步驟進行的話，那麼在您工作列上應該可以看到 
          VNC viewer 這個應用程式的 icon，請直接點選來執行，此時應該可以看到如下的畫面：</p>
        <p align="center"> <img src="vnc16.png" tppabs="http://www.suse.url.tw/picture/vnc16.png" width="342" height="133"><br>
          <font size="2">圖一：指定 VNC viewer 欲連線之主機</font> </p>
        <p>請將您 Linux 主機位址填寫進去吧，另外要注意到在位址後端需指定 VNC 所提供的 X Server 視窗編號噢。沒問題的話請點選 
          [OK]，接下來即會要求您輸入當初在 VNC Server 上所設定的密碼：</p>
        <p align="center"><img src="vnc19.png" tppabs="http://www.suse.url.tw/picture/vnc19.png" width="368" height="99"><br>
          <font color="#000000" size="2">圖二：指定連線密碼 </font></p>
        <p>這時候應該能順利看到 Linux 的視窗桌面了。另外如果想開啟多個視窗桌面，那麼請點選圖一底下的 [options] 項目，並於 [Misc] 
          中把 [Shared connection] 選項打勾即可：</p>
        <p align="center"><img src="vnc17.png" tppabs="http://www.suse.url.tw/picture/vnc17.png" width="352" height="352"><br>
          <font size="2">圖三：設定能開啟多視窗畫面</font> </p>
        <p>而在此選項底下，還有個 [Full-screen mode]，這當然就是全螢幕模式囉 ﹔在您調整成 Full-screen mode 
          後，如想調整回來，可按下 F8 並選取 [還原] 就行了。調整完畢，請把設定值保留起來：</p>
        <p align="center"><img src="vnc18.png" tppabs="http://www.suse.url.tw/picture/vnc18.png" width="352" height="352"><br>
          <font size="2">圖四：儲存設定參數畫面 </font></p>
        <blockquote> 
          <p><strong><font color="#000099">Tips：</font></strong><font color="#000099" size="2">剛剛在 
            linux 上頭是使用 root 的身分來設定 VNC Server，所以在連線成功後，您所操控的可是 root 的桌面噢。現在要是想換成一般 
            user 又如何呢 ? 一樣的步驟啦，只是在 VNC server 端須換成以一般使用者身分執行 vncserver 而已，其他步驟都相同噢。</font></p>
        </blockquote>
        </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td align="center"><img src="icon.jpg" tppabs="http://www.suse.url.tw/picture/icon.jpg" width="11" height="11"></td>
      <td><strong><font color="#000099">使用網頁瀏覽器</font></strong></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td><p>如果您沒安裝 VNC viewer 軟體也沒關係啦，直接於瀏覽器的網址處輸入 VNC server 的位址即可：</p>
        <p align="center"><img src="vnc20.png" tppabs="http://www.suse.url.tw/picture/vnc20.png" width="534" height="340"></p>
        <p>請留意網址後端的連接埠須指定 5801 port，也就是把 5800 port 加上您 VNC server 所提供的 X Server 
          視窗編號 ﹔如果當初 VNC server 提供的視窗編號是 2 的話，那這裡就須指定 5802 port。</p></td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td align="center">&nbsp;</td>
      <td>&nbsp;</td>
    </tr>
  </table>
  <p><font color="#000000"><font size="+1"><strong> <a name="17"></a><font size="5">19.2.4 
    Linux 遠端遙控 Windows</font><br>
    </strong></font><br>
    　假如您 Windows 上頭的 VNC server 已啟動，且也已設定好連線密碼了，接著就可以在 Linux 上作測試囉。首先請您登入 X-Window，開啟一個 
    terminal 並執行 vncviewer 指令，然後輸入 server 的 IP 及連線密碼即可：</font></p>
  <p align="center"><img src="vnc22.png" tppabs="http://www.suse.url.tw/picture/vnc22.png" width="671" height="232"></p>
  <p align="center"><font color="#000000"><img src="vnc23.png" tppabs="http://www.suse.url.tw/picture/vnc23.png" width="671" height="227"></font></p>
  <p align="left"><font color="#000000">　認證成功後，就可以開始遠端操控 Windows 了噢。另外如果您是想使用瀏覽器做連線的話，請於 
    URL 上頭輸入： http://192.168.1.220:5800/，自己試試看吧 !<br>
    <br>
    　不同作業系統間的 VNC 操作，大致是如此啦，簡單吧 ! 接著您可自行練習在兩台同為 Windows 或 Linux 的主機上做 VNC 遠端操控囉。<br>
    <br>
    <em>　　　　</em> </font> </p>
  </div>
<p align="center"><font color="#000000"><em>copyright &copy; 2006 by barry ( 柏青哥 
  )</em></font> <br>
</p>
 
</body>
</html>
